{"version":3,"file":"app.min.js","sources":["../../app/app.js","../../app/components/videodetail/zencoder-service.js","../../app/components/videodetail/videodetail-controller.js","../../app/components/videodetail/videofield-directive.js","../../app/shared/videoplayermodal/videoplayermodal-directive.js","../../app/components/videolistpage/videolist-controller.js","../../app/components/login/login-controller.js","../../app/components/season/season-directive.js","../../app/components/season/season-service.js","../../app/components/channel/channel-service.js","../../app/components/channel/channeldetail-controller.js","../../app/components/channellistpage/channellist-controller.js","../../app/components/serieslistpage/serieslist-controller.js","../../app/components/series/series-service.js","../../app/components/seriesdetail/seriesdetail-controller.js","../../app/components/sponsor/sponsor-directive.js","../../app/components/sponsor/sponsor-service.js","../../app/shared/alert/alert-directive.js","../../app/shared/alert/alert-service.js","../../app/shared/auth/tokenauth-service.js","../../app/shared/pagination/dirPagination.js","../../app/shared/chart/chart-directive.js","../../app/shared/converttolocal/converttolocal-filter.js","../../app/shared/datepicker/datepicker-directive.js","../../app/shared/listservice/list-service.js","../../app/shared/navbar/navbar-directive.js","../../app/shared/navbar/navbarconfig-service.js","../../app/shared/placeholderimage/placeholderimage-filter.js","../../app/shared/api/video-service.js","../../app/shared/autocomplete/autocomplete-directive.js","../../app/shared/bettycropper/betty-cropper.js","../../app/shared/bettycropper/bettyeditable.js","../../app/shared/bettycropper/imagecropmodal.js","../../app/shared/bettycropper/openimagecropmodal.js","../../app/shared/currentuser/currentuser-service.js"],"names":["angular","module","config","$locationProvider","$httpProvider","$routeProvider","$sceDelegateProvider","RestangularProvider","resourceUrlWhitelist","html5Mode","setBaseUrl","addResponseInterceptor","data","operation","results","meta","count","prev","next","when","templateUrl","controller","reloadOnSearch","otherwise","redirectTo","constant","UPLOAD_TO_S3_PROGRESS_MESSAGE","UPLOAD_TO_S3_UPLOAD_BEGINNING_MESSAGE","UPLOAD_TO_S3_UPLOAD_COMPLETE_MESSAGE","UPLOAD_TO_S3_UPLOAD_FAILED_MESSAGE","ENCODE_FAILED_MESSAGE","ENCODE_PROGRESS_MESSAGE","service","$http","$q","$interval","ZencoderConstants","uploadToS3","file","videoObject","s3Config","encoding_payload","s3deferred","defer","formData","FormData","append","key","AWSAccessKeyId","acl","success_action_status","policy","signature","xhr","XMLHttpRequest","open","upload_endpoint","upload","onprogress","e","notify","lengthComputable","replace","Math","round","loaded","total","onload","resolve","addEventListener","reject","send","promise","encode","encodeDeferred","doPost","success","response","zencoderProgressEndpoint","json","progressInterval","url","method","ignoreAuthorizationHeader","then","state","cancel","_","isUndefined","progress","error","this","uploadToS3AndEncode","uploadToS3AndEncodeDeferred","successCallback","errorCallback","notifyCallback","SAVED_ALERT_MESSAGE","SOMETHING_WENT_WRONG_ALERT_MESSAGE","PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE","$scope","$routeParams","VideoService","$location","AlertService","VideoDetailControllerConstants","NavBarConfigService","navigateToNewlyCreatedEditPage","displaySaveSuccessfulAlert","path","id","displaySomethingWentWrongAlert","setShowSearchBar","video","getVideo","videoId","one","get","console","log","saveVideo","videoDetailForm","$valid","save","post","FILE_TOO_LARGE_ERROR_MESSAGE","MUST_UPLOAD_FILES_ERROR_MESSAGE","PLEASE_SELECT_A_FILE_ERROR_MESSAGE","UPLOAD_COMPLETE_SUCCESS_MESSAGE","directive","Zencoder","transclude","$timeout","VideoFieldConstants","checkIfSourcesHaveLoadedAndRetryIfTheyAreNot","isEmpty","sources","fetchNewVideoObject","clear","uploadVideo","fileField","$","unbind","bind","event","target","files","validateVideoFile","addVideo","message","info","click","validateVideoFileDeferred","size","type","indexOf","addVideoDeferred","uploadToS3Arguments","restrict","link","scope","element","currentVideo","find","player","videojs","controls","autoplay","width","height","on","pause","$on","dispose","$rootScope","ListService","orderBy","search","filter","f","q","setService","updateList","list","totalItems","setFilterAndUpdateList","newFilterValue","changeToEditPage","setOrderAndUpdateList","newOrderValue","clearSearchAndUpdateList","pageChanged","newPageNumber","setSearchAndUpdatePage","new","setUpdateListFunction","authService","showSearchBar","showSaveButton","username","password","submitLogin","login","season","factory","Restangular","ChannelService","ChannelDetailControllerConstants","channel","getChannel","channelId","saveChannel","channelDetailForm","SeriesService","SeriesDetailControllerConstants","series","getSeries","seriesId","saveSeries","seriesDetailForm","sponsor","alertStatus","TIME_TO_WAIT_BEFORE_CLEARING","AlertServiceConstants","clearAfterDisplayingMessageFlag","setAlertStatusElementsToFalse","alertDeferred","alertService","$window","$injector","httpRequestBuffer","request","headers","sessionStorage","token","Authorization","responseError","ignoreAuthModule","status","deferred","refreshToken","interceptors","push","_login","_refreshToken","retryAll","rejectAll","_retryHttpRequest","buffer","reason","each","moduleName","templatePath","err","$compile","$parse","paginationService","terminal","multiElement","priority","compile","tElement","tAttrs","hasAttribute","$set","dirPaginate","eq","length","attr","expression","match","filterPattern","itemsPerPageFilterRemoved","collectionGetter","paginationId","registerInstance","attrs","currentPageGetter","compiled","currentPage","defaultCurrentPage","setCurrentPageParser","setAsyncModeTrue","$watch","result","setCollectionLength","$watchCollection","collection","generatePagesArray","collectionLength","rowsPerPage","paginationRange","position","pages","totalPages","ceil","halfWay","ellipsesNeeded","i","pageNumber","calculatePageNumber","openingEllipsesNeeded","closingEllipsesNeeded","numberRegex","elem","maxSize","onPageChange","goToPage","num","isValidPageNumber","getCollectionLength","getItemsPerPage","pagination","current","generatePagination","page","parseInt","getCurrentPage","last","setCurrent","test","directionLinks","isDefined","$parent","$eval","boundaryLinks","isRegistered","idMessage","max","previousPage","setCurrentPage","itemsPerPage","end","start","Array","isAsyncMode","setItemsPerPage","slice","lastRegisteredInstance","instances","instanceId","asyncMode","getLastInstanceId","val","currentPageParser","context","assign","parser","impressions","semiCircleConfig","options","chart","backgroundColor","margin","exporting","enabled","credits","tooltip","colors","dataLabels","states","hover","animation","startAngle","endAngle","center","innerSize","name","title","text","subtitle","loading","input","moment","utc","local","format","DATETIME_PICKER_FORMAT","MOMENTJS_FORMAT","$filter","DatetimePickerConstants","date","require","template","ngModel","convertToLocal","value","required","datetimepicker","startDate","Date","step","$formatters","unshift","formatDateForBackend","$parsers","ValidQueryParamsForListPage","currentService","serviceName","setList","params","pick","getList","logoUrl","CurrentUser","searchTerm","clearSearch","$simplified","currentUserName","displayName","flag","func","placeholderUrl","labelAttr","placeholderText","updateCurrentModelsAndDisplayDropdown","currentModels","showDropdown","modelSelected","selectedElement","controlSelectedElementWithKeyboard","keyCode","lastIndexOfCurrentModels","toggleDropdownStatus","setModel","newValue","model","BettyCropperService","$interpolate","IMAGE_SERVER_URL","BC_API_KEY","BettyImage","uploadImageDeferred","fileInputId","remove","fileInput","inputTemplate","imageData","X-Betty-Api-Key","Content-Type","undefined","X-CSRFToken","transformRequest","identity","transformResponse","parseJSON","image","detailPatch","credit","selections","updateSelection","ratio","detail","BettyImageFactory","DEFAULT_IMAGE_WIDTH","Selection","prototype","scaleToFit","scale","fitRatio","thisRatio","scaled","getStyles","selection","scaledSelection","background-image","background-size","floor","background-position","x0","y0","background-repeat","exp","idStr","toString","segmentedId","substr","base_url","x1","y1","source","SelectionFactory","scaleBy","scaledToFit","BettyCropper","openImageCropModal","addStyles","hideMetas","editable","caption","alt","bettyImage","edit","setStyles","imageStyling","parent","ratioWidth","split","ratioHeight","background-color","newImage","resize","removeImage","editImage","$modalInstance","ratios","selectedCrop","cropMode","finished","thumb_container_styles","scaleData","Jcrop","allowSelect","allowMove","allowResize","keySupport","jcrop_api","image_url","Object","keys","setThumbStyles","crop","selectCrop","setOptions","aspectRatio","setSelect","thumb_styles","padding-top","padding-bottom","padding-left","padding-right","jcrop_selection","tellSelect","newSelection","x","x2","y","y2","saveAndQuit","close","saveAndNext","nextRatioIndex","$modal","backdrop","userDefer","$userPromise","self","getItems","$retrieveData","user","first_name","last_name","email"],"mappings":"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","sourcesContent":["'use strict';\n\n// ****** App Config ****** \\\\\n\nangular.module('videoHub', [\n    'ngCookies',\n    'ngRoute',\n    'ngAnimate',\n    'ngMessages',\n    'restangular',\n    'highcharts-ng',\n    'BettyCropper',\n    'ui.bootstrap'\n  ])\n  .config(function($locationProvider, $httpProvider, $routeProvider, $sceDelegateProvider, RestangularProvider) {\n    //Add some stuff to the whitelist to prevent XSS blocking stuff\n    $sceDelegateProvider.resourceUrlWhitelist(['self', 'http://assets.onionstatic.com/videoads/*', 'http://onionwebtech.s3.amazonaws.com/videoads/**', 'http://onionwebtech.s3.amazonaws.com/videoads-test/**']);\n\n    $locationProvider.html5Mode(true);\n\n    //Set the base URL for the Restangular stuff\n    RestangularProvider.setBaseUrl('/api/v0/');\n\n    //We need a response interceptor for 'getList' becuase it contains additional metadata that is normally stripped out by restangular\n    RestangularProvider.addResponseInterceptor(function(data, operation) {\n      if (operation === 'getList') {\n        var results = data.results;\n        if (results){\n          results.meta = {\n            count: data.count,\n            prev: data.prev,\n            next: data.next\n          };\n        }\n        return results;\n      }\n      return data;\n    });\n\n    $routeProvider\n      .when('/', {\n        templateUrl: 'components/videolistpage/videolist.html',\n        controller: 'VideoListController',\n        reloadOnSearch: false\n      })\n      .when('/series', {\n        templateUrl: 'components/serieslistpage/serieslist.html',\n        controller: 'SeriesListController',\n        reloadOnSearch: false\n      })\n      .when('/channels', {\n        templateUrl: 'components/channellistpage/channellist.html',\n        controller: 'ChannelListController',\n        reloadOnSearch: false\n      })\n      .when('/login', {\n        templateUrl: 'components/login/login.html',\n        controller: 'LoginController'\n      })\n      .when('/edit/:videoId/', {\n        templateUrl: 'components/videodetail/videoDetail.html',\n        controller: 'VideoDetailController'\n      })\n      .when('/editchannel/:channelId', {\n        templateUrl: 'components/channel/channeldetail.html',\n        controller: 'ChannelDetailController'\n      })\n      .when('/newchannel/', {\n        templateUrl: 'components/channel/channeldetail.html',\n        controller: 'ChannelDetailController'\n      })\n      .when('/editseries/:seriesId', {\n        templateUrl: 'components/seriesdetail/seriesdetail.html',\n        controller: 'SeriesDetailController'\n      })\n      .when('/newseries/', {\n        templateUrl: 'components/seriesdetail/seriesdetail.html',\n        controller: 'SeriesDetailController'\n      })\n      .when('/new/', {\n        templateUrl: 'components/videodetail/videodetail.html',\n        controller: 'VideoDetailController'\n      })\n      // .when('/exclusion/:exclusionName/', {\n      //   templateUrl: 'components/exclusion/exclusion.html',\n      //   controller: 'ExclusionCtrl'\n      // })\n      .otherwise({\n        redirectTo: '/'\n      });\n  })\n  .constant('ValidQueryParamsForListPage', [\n    'q', 'page', 'f', 'page_size', 'order_by'\n  ]);\n","'use strict';\n\nangular.module('videoHub')\n  .constant('ZencoderConstants', {\n    'UPLOAD_TO_S3_PROGRESS_MESSAGE': 'Uploading X% complete',\n    'UPLOAD_TO_S3_UPLOAD_BEGINNING_MESSAGE':  'Uploading...',\n    'UPLOAD_TO_S3_UPLOAD_COMPLETE_MESSAGE': 'Upload Complete. Begin Encoding.',\n    'UPLOAD_TO_S3_UPLOAD_FAILED_MESSAGE': 'Upload Failed',\n    'ENCODE_FAILED_MESSAGE': 'Encoding has failed.',\n    'ENCODE_PROGRESS_MESSAGE': 'Encoding: X%'\n  })\n  .service('Zencoder', function Zencoder($http, $q, $interval, ZencoderConstants) {\n\n    //TODO: this config object is awful\n    this.uploadToS3AndEncode = function(config) {\n      var uploadToS3AndEncodeDeferred = $q.defer();\n      var file = config.file;\n      var videoObject = config.videoObject;\n      //TODO: MOve into own function\n      var successCallback = function(success) {\n        uploadToS3AndEncodeDeferred.resolve(success);\n      };\n      var errorCallback = function(error) {\n        uploadToS3AndEncodeDeferred.reject(error);\n      };\n      var notifyCallback = function(notify) {\n        uploadToS3AndEncodeDeferred.notify(notify);\n      };\n\n      uploadToS3(file, videoObject)\n        .then(encode, errorCallback, notifyCallback)\n        .then(successCallback, errorCallback, notifyCallback);\n\n      return uploadToS3AndEncodeDeferred.promise;\n    };\n\n    function uploadToS3(file, videoObject) {\n      var s3Config = videoObject.encoding_payload;\n      var s3deferred = $q.defer();\n      //TODO: setup form data function\n      var formData = new FormData();\n      formData.append('key', s3Config.key);\n      formData.append('AWSAccessKeyId', s3Config.AWSAccessKeyId);\n      formData.append('acl', s3Config.acl);\n      formData.append('success_action_status', s3Config.success_action_status);\n      formData.append('policy', s3Config.policy);\n      formData.append('signature', s3Config.signature);\n      formData.append('file', file);\n      //We use XMLHttpRequest here becuase angular's http methods don't support progress updates.\n      //TODO: move this into separate function\n      var xhr = new XMLHttpRequest();\n      xhr.open('POST', s3Config.upload_endpoint);\n\n      xhr.upload.onprogress = function(e) {\n        if (e.lengthComputable) {\n          s3deferred.notify(ZencoderConstants.UPLOAD_TO_S3_PROGRESS_MESSAGE.replace('X', Math.round(e.loaded / e.total * 100)));\n        } else {\n          s3deferred.notify(ZencoderConstants.UPLOAD_TO_S3_UPLOAD_BEGINNING_MESSAGE);\n        }\n      };\n\n      xhr.onload = function() {\n        s3deferred.notify(ZencoderConstants.UPLOAD_TO_S3_UPLOAD_COMPLETE_MESSAGE);\n        s3deferred.resolve(videoObject);\n      };\n\n      xhr.addEventListener('error', function() {\n        s3deferred.reject(ZencoderConstants.UPLOAD_TO_S3_UPLOAD_FAILED_MESSAGE);\n      });\n\n      xhr.send(formData);\n      return s3deferred.promise;\n\n    }\n\n    function encode(videoObject) {\n      var encodeDeferred = $q.defer();\n      videoObject.doPost('encode')\n        .success(function(response) {\n        var zencoderProgressEndpoint = response.json;\n        var progressInterval = $interval(function() {\n          $http({\n            url: zencoderProgressEndpoint,\n            method: 'GET',\n            'ignoreAuthorizationHeader': true\n          }).then(function(response) {\n            if (response.data.state === 'finished') {\n              encodeDeferred.resolve(videoObject);\n              $interval.cancel(progressInterval);\n            } else if (response.data.state === 'failed') {\n              encodeDeferred.reject(ZencoderConstants.ENCODE_FAILED_MESSAGE);\n              $interval.cancel(progressInterval);\n            } else {\n              if (!_.isUndefined(response.data.progress)) {\n                encodeDeferred.notify(ZencoderConstants.ENCODE_PROGRESS_MESSAGE.replace('X', Math.round(response.data.progress)));\n              }\n            }\n          });\n        }, 1000);\n      }).error(function(data) {\n        encodeDeferred.reject(data);\n      });\n      return encodeDeferred.promise;\n    }\n  });\n","'use strict';\nangular.module('videoHub')\n  .constant('VideoDetailControllerConstants', {\n    SAVED_ALERT_MESSAGE: 'Saved',\n    SOMETHING_WENT_WRONG_ALERT_MESSAGE: 'Something went wrong with saving the Video. Please call your friendly sysadmin.',\n    PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE: 'Please fill in all required fields.'\n  })\n  .controller('VideoDetailController', function($scope, $routeParams, VideoService, $location, AlertService, VideoDetailControllerConstants, NavBarConfigService) {\n    NavBarConfigService.setShowSearchBar(false);\n    $scope.video = {};\n\n    $scope.getVideo = function() {\n      if (_.isUndefined($routeParams.videoId)) {\n        $scope.video = {};\n      } else {\n        return VideoService.one($routeParams.videoId).get().then(\n          function(data) {\n            $scope.video = data;\n          },\n          function(data) {\n            console.log(data);\n          }\n        );\n      }\n    };\n\n    $scope.saveVideo = function() {\n      if ($scope.videoDetailForm.$valid) {\n        if ($routeParams.videoId) {\n          $scope.video.save().then(displaySaveSuccessfulAlert, displaySomethingWentWrongAlert);\n        } else {\n          VideoService.post($scope.video).then(navigateToNewlyCreatedEditPage, displaySomethingWentWrongAlert);\n        }\n      } else {\n        AlertService.error(VideoDetailControllerConstants.PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE, true);\n      }\n    };\n\n    function navigateToNewlyCreatedEditPage(response) {\n      displaySaveSuccessfulAlert().then(function() {\n        $location.path('/edit/' + response.id + '/');\n      });\n    }\n\n    function displaySaveSuccessfulAlert() {\n      return AlertService.success(VideoDetailControllerConstants.SAVED_ALERT_MESSAGE, true);\n    }\n\n    function displaySomethingWentWrongAlert() {\n      AlertService.error(VideoDetailControllerConstants.SOMETHING_WENT_WRONG_ALERT_MESSAGE, true);\n    }\n    $scope.getVideo();\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .constant('VideoFieldConstants', {\n    FILE_TOO_LARGE_ERROR_MESSAGE: 'Upload file cannot be larger than 1024MB.',\n    MUST_UPLOAD_FILES_ERROR_MESSAGE: 'You must upload a video file.',\n    PLEASE_SELECT_A_FILE_ERROR_MESSAGE: 'Please select a file.',\n    UPLOAD_COMPLETE_SUCCESS_MESSAGE: 'Upload Complete'\n  })\n  .directive('videoField', function(Zencoder, $q) {\n    return {\n      templateUrl: 'components/videodetail/videofield.html',\n      transclude: true,\n      controller: function($scope, AlertService, $timeout, VideoFieldConstants, VideoService) {\n\n        $scope.uploadVideo = function() {\n          var fileField = $('#' + $scope.video.id + '-file-field');\n          fileField.unbind('change');\n          fileField.bind('change', function(event) {\n            var file = event.target.files[0];\n            $scope.validateVideoFile(file)\n              .then($scope.addVideo)\n              .then(Zencoder.uploadToS3AndEncode)\n              .then(\n                function() {\n                  AlertService.success(VideoFieldConstants.UPLOAD_COMPLETE_SUCCESS_MESSAGE).then($scope.fetchNewVideoObject);\n                },\n                function(error) {\n                  AlertService.error(error, true);\n                },\n                function(message) {\n                  if (!_.isUndefined(message)) {\n                    AlertService.info(message);\n                  }\n                });\n          });\n          fileField.click();\n        };\n\n        $scope.validateVideoFile = function(file) {\n          var validateVideoFileDeferred = $q.defer();\n          if (file) {\n            if (file.size > (1024 * 1024 * 1024)) {\n              validateVideoFileDeferred.reject(VideoFieldConstants.FILE_TOO_LARGE_ERROR_MESSAGE);\n            } else if (file.type.indexOf('video/') !== 0) {\n              validateVideoFileDeferred.reject(VideoFieldConstants.MUST_UPLOAD_FILES_ERROR_MESSAGE);\n            } else {\n              validateVideoFileDeferred.resolve(file);\n            }\n          } else {\n            validateVideoFileDeferred.reject(VideoFieldConstants.PLEASE_SELECT_A_FILE_ERROR_MESSAGE);\n          }\n          return validateVideoFileDeferred.promise;\n        };\n\n        $scope.addVideo = function(file) {\n          var addVideoDeferred = $q.defer();\n          $scope.video.save().then(function() {\n            var uploadToS3Arguments = {\n              'file': file,\n              'videoObject': $scope.video\n            };\n            addVideoDeferred.resolve(uploadToS3Arguments);\n          });\n          return addVideoDeferred.promise;\n        };\n\n        function checkIfSourcesHaveLoadedAndRetryIfTheyAreNot(response) {\n          if (_.isEmpty(response.data.sources)) {\n            $timeout($scope.fetchNewVideoObject, 2000);\n          } else {\n            $scope.video = response.data;\n            AlertService.clear();\n          }\n        }\n\n        $scope.fetchNewVideoObject = function() {\n          // We reload the video after all of the fun is over, in order to update it with the new sources.\n          VideoService.one($scope.video.id).get()\n            .then(checkIfSourcesHaveLoadedAndRetryIfTheyAreNot);\n        };\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .directive('videoPlayerModal', [ function() {\n    return {\n      replace: false,\n      restrict: 'E',\n      transclude: true,\n      templateUrl: 'shared/videoplayermodal/videoplayermodal.html',\n      link: function(scope, element) {\n        var currentVideo = element.find('video')[0];\n        scope.player = videojs(currentVideo, {\n          'controls': true,\n          'autoplay': false,\n          'width': 'auto',\n          'height': 'auto'\n        });\n\n        element.find('.modal').on('hidden.bs.modal', function(){\n          scope.player.pause();\n        });\n\n        scope.$on('$destroy', function(){\n          scope.player.dispose();\n        });\n      }\n    };\n  }]);\n","'use strict';\nangular.module('videoHub')\n  .controller('VideoListController', function($scope, $location, $routeParams, $rootScope, ListService, NavBarConfigService) {\n    NavBarConfigService.setShowSearchBar(true);\n    $scope.orderBy = $location.search()['order_by'];\n    $scope.filter = $location.search().f;\n    $scope.search = $location.search().q;\n    ListService.setService('VideoService');\n    ListService.updateList()\n      .then(function() {\n        $scope.list = ListService.data.list;\n        $scope.totalItems = ListService.data.totalItems;\n      });\n\n    $scope.setFilterAndUpdateList = function(newFilterValue){\n      //Only used to determine active state\n      $scope.filter = newFilterValue;\n      $location.search('f', newFilterValue);\n      ListService.updateList();\n    };\n\n    $scope.changeToEditPage = function(id){\n      $location.path('/edit/' + id + '/');\n    };\n\n    $scope.setOrderAndUpdateList = function(newOrderValue){\n      if ($scope.orderBy && ($scope.orderBy.indexOf(newOrderValue) > -1 && $scope.orderBy.indexOf('-') === -1)){\n        $scope.orderBy = '-' + newOrderValue;\n      } else {\n        $scope.orderBy = newOrderValue;\n      }\n      $location.search('order_by', $scope.orderBy);\n      ListService.updateList();\n    };\n\n    $scope.clearSearchAndUpdateList = function(){\n      $scope.search = '';\n      $location.search('q', null);\n      ListService.updateList();\n    };\n\n    $scope.pageChanged = function(newPageNumber) {\n      $location.search('page', newPageNumber);\n      ListService.updateList();\n    };\n\n    $scope.setSearchAndUpdatePage = function(){\n      $location.search('q', $scope.search);\n      ListService.updateList();\n    };\n\n    $scope.new = function() {\n      $location.path('/new/');\n    };\n    NavBarConfigService.setUpdateListFunction(ListService.updateList);\n\n  });\n","'use strict';\n\nangular.module('videoHub')\n    .controller('LoginController', function($scope, authService, $location, $rootScope) {\n        $rootScope.showSearchBar = false;\n        $rootScope.showSaveButton = false;\n        $scope.username = '';\n        $scope.password = '';\n        $scope.submitLogin = function() {\n            authService.login($scope.username, $scope.password);\n        };\n    });\n","'use strict';\nangular.module('videoHub')\n  .directive('season', function(){\n    return {\n      templateUrl: 'components/season/season.html',\n      scope: {\n        'season': '='\n      },\n    };\n  });\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('SeasonService',\nfunction(Restangular) {\n  return Restangular.service('seasons');\n});\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('ChannelService',\nfunction(Restangular) {\n  return Restangular.service('channel');\n});\n","'use strict';\nangular.module('videoHub')\n  .constant('ChannelDetailControllerConstants', {\n    SAVED_ALERT_MESSAGE: 'Saved',\n    SOMETHING_WENT_WRONG_ALERT_MESSAGE: 'Something went wrong with saving the Channel. Please call your friendly sysadmin.',\n    PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE: 'Please fill in all required fields.'\n  })\n  .controller('ChannelDetailController', function($scope, $routeParams, ChannelService, $location, AlertService, ChannelDetailControllerConstants, NavBarConfigService) {\n    NavBarConfigService.setShowSearchBar(false);\n    $scope.channel = {};\n\n    $scope.getChannel = function() {\n      if (_.isUndefined($routeParams.channelId)) {\n        $scope.channel = {};\n      } else {\n        return ChannelService.one($routeParams.channelId).get().then(\n          function(data) {\n            $scope.channel = data;\n          },\n          function(data) {\n            console.log(data);\n          }\n        );\n      }\n    };\n\n    $scope.saveChannel = function() {\n      if ($scope.channelDetailForm.$valid) {\n        if ($routeParams.channelId) {\n          $scope.channel.save().then(displaySaveSuccessfulAlert, displaySomethingWentWrongAlert);\n        } else {\n          ChannelService.post($scope.channel).then(navigateToNewlyCreatedEditPage, displaySomethingWentWrongAlert);\n        }\n      } else {\n        AlertService.error(ChannelDetailControllerConstants.PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE, true);\n      }\n    };\n\n    function navigateToNewlyCreatedEditPage(response) {\n      displaySaveSuccessfulAlert().then(function() {\n        $location.path('/edit/' + response.id + '/');\n      });\n    }\n\n    function displaySaveSuccessfulAlert() {\n      return AlertService.success(ChannelDetailControllerConstants.SAVED_ALERT_MESSAGE, true);\n    }\n\n    function displaySomethingWentWrongAlert() {\n      AlertService.error(ChannelDetailControllerConstants.SOMETHING_WENT_WRONG_ALERT_MESSAGE, true);\n    }\n    $scope.getChannel();\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('ChannelListController', function($scope, $location, $routeParams, $rootScope, ListService, NavBarConfigService) {\n    NavBarConfigService.setShowSearchBar(true);\n    $scope.orderBy = $location.search()['order_by'];\n    $scope.search = $location.search().q;\n    ListService.setService('ChannelService');\n    ListService.updateList()\n      .then(function() {\n        $scope.list = ListService.data.list;\n        $scope.totalItems = ListService.data.totalItems;\n      });\n\n    $scope.changeToEditPage = function(id){\n      $location.path('/editchannel/' + id + '/');\n    };\n\n    $scope.setOrderAndUpdateList = function(newOrderValue){\n      if ($scope.orderBy && ($scope.orderBy.indexOf(newOrderValue) > -1 && $scope.orderBy.indexOf('-') === -1)){\n        $scope.orderBy = '-' + newOrderValue;\n      } else {\n        $scope.orderBy = newOrderValue;\n      }\n      $location.search('order_by', $scope.orderBy);\n      ListService.updateList();\n    };\n\n    $scope.clearSearchAndUpdateList = function(){\n      $scope.search = '';\n      $location.search('q', null);\n      ListService.updateList();\n    };\n\n    $scope.pageChanged = function(newPageNumber) {\n      $location.search('page', newPageNumber);\n      ListService.updateList();\n    };\n\n    $scope.setSearchAndUpdatePage = function(){\n      $location.search('q', $scope.search);\n      ListService.updateList();\n    };\n\n    $scope.new = function() {\n      $location.path('/newchannel/');\n    };\n    NavBarConfigService.setUpdateListFunction(ListService.updateList);\n\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('SeriesListController', function($scope, $location, $routeParams, $rootScope, ListService, NavBarConfigService) {\n    NavBarConfigService.setShowSearchBar(true);\n    $scope.orderBy = $location.search()['order_by'];\n    $scope.search = $location.search().q;\n    ListService.setService('SeriesService');\n    ListService.updateList()\n      .then(function() {\n        $scope.list = ListService.data.list;\n        $scope.totalItems = ListService.data.totalItems;\n      });\n\n    $scope.changeToEditPage = function(id){\n      $location.path('/editseries/' + id + '/');\n    };\n\n    $scope.setOrderAndUpdateList = function(newOrderValue){\n      if ($scope.orderBy && ($scope.orderBy.indexOf(newOrderValue) > -1 && $scope.orderBy.indexOf('-') === -1)){\n        $scope.orderBy = '-' + newOrderValue;\n      } else {\n        $scope.orderBy = newOrderValue;\n      }\n      $location.search('order_by', $scope.orderBy);\n      ListService.updateList();\n    };\n\n    $scope.clearSearchAndUpdateList = function(){\n      $scope.search = '';\n      $location.search('q', null);\n      ListService.updateList();\n    };\n\n    $scope.pageChanged = function(newPageNumber) {\n      $location.search('page', newPageNumber);\n      ListService.updateList();\n    };\n\n    $scope.setSearchAndUpdatePage = function(){\n      $location.search('q', $scope.search);\n      ListService.updateList();\n    };\n\n    $scope.new = function() {\n      $location.path('/newseries/');\n    };\n    NavBarConfigService.setUpdateListFunction(ListService.updateList);\n\n  });\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('SeriesService',\nfunction(Restangular) {\n  return Restangular.service('series');\n});\n","'use strict';\n\nangular.module('videoHub')\n  .constant('SeriesDetailControllerConstants', {\n    SAVED_ALERT_MESSAGE: 'Saved',\n    SOMETHING_WENT_WRONG_ALERT_MESSAGE: 'Something went wrong with saving the Series. Please call your friendly sysadmin.',\n    PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE: 'Please fill in all required fields.'\n  })\n  .controller('SeriesDetailController', function($scope, $routeParams, SeriesService, $location, AlertService, SeriesDetailControllerConstants, NavBarConfigService) {\n    NavBarConfigService.setShowSearchBar(false);\n    $scope.series = {};\n\n    $scope.getSeries = function() {\n      if (_.isUndefined($routeParams.seriesId)) {\n        $scope.series = {};\n      } else {\n        return SeriesService.one($routeParams.seriesId).get().then(\n          function(data) {\n            $scope.series = data;\n          },\n          function(data) {\n            console.log(data);\n          }\n        );\n      }\n    };\n\n    $scope.saveSeries = function() {\n      if ($scope.seriesDetailForm.$valid) {\n        if ($routeParams.seriesId) {\n          $scope.series.save().then(displaySaveSuccessfulAlert, displaySomethingWentWrongAlert);\n        } else {\n          SeriesService.post($scope.series).then(navigateToNewlyCreatedEditPage, displaySomethingWentWrongAlert);\n        }\n      } else {\n        AlertService.error(SeriesDetailControllerConstants.PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE, true);\n      }\n    };\n\n    function navigateToNewlyCreatedEditPage(response) {\n      displaySaveSuccessfulAlert().then(function() {\n        $location.path('/edit/' + response.id + '/');\n      });\n    }\n\n    function displaySaveSuccessfulAlert() {\n      return AlertService.success(SeriesDetailControllerConstants.SAVED_ALERT_MESSAGE, true);\n    }\n\n    function displaySomethingWentWrongAlert() {\n      AlertService.error(SeriesDetailControllerConstants.SOMETHING_WENT_WRONG_ALERT_MESSAGE, true);\n    }\n    $scope.getSeries();\n  });\n","'use strict';\nangular.module('videoHub')\n  .directive('sponsor', function(){\n    return {\n      templateUrl: 'components/sponsor/sponsor.html',\n      scope: {\n        'sponsor': '='\n      },\n    };\n  });\n","\n'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('SponsorService',\nfunction(Restangular) {\n  return Restangular.service('sponsor');\n});\n","'use strict';\nangular.module('videoHub')\n  .directive('alertbar', function() {\n    return {\n      templateUrl: 'shared/alert/alert-directive.html',\n      restrict: 'E',\n      controller: function($scope, AlertService) {\n        $scope.alertStatus = AlertService.alertStatus;\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .constant('AlertServiceConstants', {\n    TIME_TO_WAIT_BEFORE_CLEARING: 2000\n  })\n  .service('AlertService', function($timeout, $q, AlertServiceConstants) {\n    this.alertStatus = {};\n    this.clear = function(clearAfterDisplayingMessageFlag) {\n      if (_.isUndefined(clearAfterDisplayingMessageFlag)){\n        this.setAlertStatusElementsToFalse();\n      }\n      var alertDeferred = $q.defer();\n      var alertService = this;\n      if (clearAfterDisplayingMessageFlag) {\n        $timeout(function() {\n          alertService.setAlertStatusElementsToFalse();\n          alertDeferred.resolve();\n        }, AlertServiceConstants.TIME_TO_WAIT_BEFORE_CLEARING);\n      } else {\n        alertDeferred.resolve();\n      }\n\n      return alertDeferred.promise;\n    };\n\n    this.setAlertStatusElementsToFalse = function(){\n      this.alertStatus.error = false;\n      this.alertStatus.info = false;\n      this.alertStatus.success = false;\n    };\n\n    this.success = function(message, clearAfterDisplayingMessageFlag) {\n      this.clear();\n      this.alertStatus.success = message;\n      return this.clear(clearAfterDisplayingMessageFlag);\n    };\n    this.error = function(message, clearAfterDisplayingMessageFlag) {\n      this.clear();\n      this.alertStatus.error = message;\n      return this.clear(clearAfterDisplayingMessageFlag);\n    };\n    this.info = function(message, clearAfterDisplayingMessageFlag) {\n      this.clear();\n      this.alertStatus.info = message;\n      return this.clear(clearAfterDisplayingMessageFlag);\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .factory('authInterceptor', ['$rootScope', '$q', '$window', '$location', '$injector', 'httpRequestBuffer', function($rootScope, $q, $window, $location, $injector, httpRequestBuffer) {\n    return {\n      'request': function(config) {\n        config.headers = config.headers || {};\n        if ($window.sessionStorage.token) {\n          if (!config.ignoreAuthorizationHeader) {\n            config.headers.Authorization = 'JWT ' + $window.sessionStorage.token;\n          }\n        }\n        return config;\n      },\n      'responseError': function(response) {\n        if (response.config) {\n          var ignoreAuthModule = response.config.ignoreAuthModule || response.config.headers.ignoreAuthModule;\n          if (!ignoreAuthModule) {\n            if (response.status === 403) {\n              var deferred = $q.defer();\n              httpRequestBuffer.append(response.config, deferred);\n              var authService = $injector.get('authService');\n              authService.refreshToken();\n            }\n          }\n        }\n        return $q.reject(response);\n      }\n    };\n  }])\n  .config(['$httpProvider', function($httpProvider) {\n    $httpProvider.interceptors.push('authInterceptor');\n  }])\n  .service('authService', ['$window', '$http', '$rootScope', '$location', 'httpRequestBuffer', function($window, $http, $rootScope, $location, httpRequestBuffer) {\n    var _login = function(username, password) {\n      return $http.post('/api-token-auth/', {\n          'username': username,\n          'password': password\n        })\n        .then(function(response) {\n          $window.sessionStorage.token = response.data.token;\n          $location.path('/');\n        });\n    };\n    var _refreshToken = function() {\n      //TODO: put into constant\n      return $http.post('/api-token-refresh/', {\n          'token': $window.sessionStorage.token\n        }, {\n          'ignoreAuthModule': true\n        }).success(function(response) {\n          $window.sessionStorage.token = response.token;\n          httpRequestBuffer.retryAll();\n        })\n        .error(function() {\n          httpRequestBuffer.rejectAll();\n          //TODO: put into constant\n          $location.path('/login');\n        });\n    };\n\n    return {\n      login: _login,\n      refreshToken: _refreshToken\n    };\n  }])\n  // Thanks to witoldsz/angular-http-auth\n  .factory('httpRequestBuffer', ['$injector',\n    function($injector) {\n      var buffer = [];\n\n      var $http;\n\n      function _retryHttpRequest(config, deferred) {\n        function successCallback(response) {\n          deferred.resolve(response);\n        }\n\n        function errorCallback(response) {\n          deferred.reject(response);\n        }\n        $http = $http || $injector.get('$http');\n        config.headers.ignoreAuthModule = true;\n        $http(config).then(successCallback, errorCallback);\n      }\n\n      return {\n        append: function(config, deferred) {\n          buffer.push({\n            config: config,\n            deferred: deferred\n          });\n        },\n        rejectAll: function(reason) {\n          if (reason) {\n            _.each(buffer, function(request) {\n              request.deferred.reject(reason);\n            });\n          }\n          buffer = [];\n        },\n        retryAll: function() {\n          _.each(buffer, function(request) {\n            _retryHttpRequest(request.config, request.deferred);\n          });\n          buffer = [];\n        }\n      };\n    }\n  ]);\n","/**\n * dirPagination - AngularJS module for paginating (almost) anything.\n *\n *\n * Credits\n * =======\n *\n * Daniel Tabuenca: https://groups.google.com/d/msg/angular/an9QpzqIYiM/r8v-3W1X5vcJ\n * for the idea on how to dynamically invoke the ng-repeat directive.\n *\n * I borrowed a couple of lines and a few attribute names from the AngularUI Bootstrap project:\n * https://github.com/angular-ui/bootstrap/blob/master/src/pagination/pagination.js\n *\n * Copyright 2014 Michael Bromley <michael@michaelbromley.co.uk>\n */\n\n(function() {\n\n    /**\n     * Config\n     */\n    var moduleName = 'videoHub';\n    var templatePath = 'shared/pagination/dirPagination.tpl.html';\n\n    /**\n     * Module\n     */\n    var module;\n    try {\n        module = angular.module(moduleName);\n    } catch(err) {\n        // named module does not exist, so create one\n        module = angular.module(moduleName, []);\n    }\n\n    module.directive('dirPaginate', ['$compile', '$parse', '$timeout', 'paginationService', function($compile, $parse, $timeout, paginationService) {\n        return  {\n            terminal: true,\n            multiElement: true,\n            priority: 5000, // This setting is used in conjunction with the later call to $compile() to prevent infinite recursion of compilation\n            compile: function dirPaginationCompileFn(tElement, tAttrs){\n\n                // Add ng-repeat to the dom element\n                if (tElement[0].hasAttribute('dir-paginate-start') || tElement[0].hasAttribute('data-dir-paginate-start')) {\n                    // using multiElement mode (dir-paginate-start, dir-paginate-end)\n                    tAttrs.$set('ngRepeatStart', tAttrs.dirPaginate);\n                    tElement.eq(tElement.length - 1).attr('ng-repeat-end', true);\n                } else {\n                    tAttrs.$set('ngRepeat', tAttrs.dirPaginate);\n                }\n\n                var expression = tAttrs.dirPaginate;\n                // regex taken directly from https://github.com/angular/angular.js/blob/master/src/ng/directive/ngRepeat.js#L211\n                var match = expression.match(/^\\s*([\\s\\S]+?)\\s+in\\s+([\\s\\S]+?)(?:\\s+track\\s+by\\s+([\\s\\S]+?))?\\s*$/);\n\n                var filterPattern = /\\|\\s*itemsPerPage\\s*:[^|]*/;\n                if (match[2].match(filterPattern) === null) {\n                    throw 'pagination directive: the \\'itemsPerPage\\' filter must be set.';\n                }\n                var itemsPerPageFilterRemoved = match[2].replace(filterPattern, '');\n                var collectionGetter = $parse(itemsPerPageFilterRemoved);\n\n                var paginationId = tAttrs.paginationId || '__default';\n                paginationService.registerInstance(paginationId);\n\n                return function dirPaginationLinkFn(scope, element, attrs){\n                    var compiled =  $compile(element, false, 5000); // we manually compile the element again, as we have now added ng-repeat. Priority less than 5000 prevents infinite recursion of compiling dirPaginate\n\n                    var currentPageGetter;\n                    if (attrs.currentPage) {\n                        currentPageGetter = $parse(attrs.currentPage);\n                    } else {\n                        // if the current-page attribute was not set, we'll make our own\n                        var defaultCurrentPage = paginationId + '__currentPage';\n                        scope[defaultCurrentPage] = 1;\n                        currentPageGetter = $parse(defaultCurrentPage);\n                    }\n                    paginationService.setCurrentPageParser(paginationId, currentPageGetter, scope);\n\n                    if (typeof attrs.totalItems !== 'undefined') {\n                        paginationService.setAsyncModeTrue(paginationId);\n                        scope.$watch(function() {\n                            return $parse(attrs.totalItems)(scope);\n                        }, function (result) {\n                            if (0 <= result) {\n                                paginationService.setCollectionLength(paginationId, result);\n                            }\n                        });\n                    } else {\n                        scope.$watchCollection(function() {\n                            return collectionGetter(scope);\n                        }, function(collection) {\n                            if (collection) {\n                                paginationService.setCollectionLength(paginationId, collection.length);\n                            }\n                        });\n                    }\n\n                    // Delegate to the link function returned by the new compilation of the ng-repeat\n                    compiled(scope);\n                };\n            }\n        };\n    }]);\n\n    module.directive('dirPaginationControls', ['paginationService', function(paginationService) {\n        var numberRegex = /^\\d+$/;\n        /**\n         * Generate an array of page numbers (or the '...' string) which is used in an ng-repeat to generate the\n         * links used in pagination\n         *\n         * @param currentPage\n         * @param rowsPerPage\n         * @param paginationRange\n         * @param collectionLength\n         * @returns {Array}\n         */\n        function generatePagesArray(currentPage, collectionLength, rowsPerPage, paginationRange) {\n            var pages = [];\n            var totalPages = Math.ceil(collectionLength / rowsPerPage);\n            var halfWay = Math.ceil(paginationRange / 2);\n            var position;\n\n            if (currentPage <= halfWay) {\n                position = 'start';\n            } else if (totalPages - halfWay < currentPage) {\n                position = 'end';\n            } else {\n                position = 'middle';\n            }\n\n            var ellipsesNeeded = paginationRange < totalPages;\n            var i = 1;\n            while (i <= totalPages && i <= paginationRange) {\n                var pageNumber = calculatePageNumber(i, currentPage, paginationRange, totalPages);\n\n                var openingEllipsesNeeded = (i === 2 && (position === 'middle' || position === 'end'));\n                var closingEllipsesNeeded = (i === paginationRange - 1 && (position === 'middle' || position === 'start'));\n                if (ellipsesNeeded && (openingEllipsesNeeded || closingEllipsesNeeded)) {\n                    pages.push('...');\n                } else {\n                    pages.push(pageNumber);\n                }\n                i ++;\n            }\n            return pages;\n        }\n\n        /**\n         * Given the position in the sequence of pagination links [i], figure out what page number corresponds to that position.\n         *\n         * @param i\n         * @param currentPage\n         * @param paginationRange\n         * @param totalPages\n         * @returns {*}\n         */\n        function calculatePageNumber(i, currentPage, paginationRange, totalPages) {\n            var halfWay = Math.ceil(paginationRange/2);\n            if (i === paginationRange) {\n                return totalPages;\n            } else if (i === 1) {\n                return i;\n            } else if (paginationRange < totalPages) {\n                if (totalPages - halfWay < currentPage) {\n                    return totalPages - paginationRange + i;\n                } else if (halfWay < currentPage) {\n                    return currentPage - halfWay + i;\n                } else {\n                    return i;\n                }\n            } else {\n                return i;\n            }\n        }\n\n        return {\n            restrict: 'AE',\n            templateUrl: function(elem, attrs) {\n                return attrs.templateUrl || templatePath;\n            },\n            scope: {\n                maxSize: '=?',\n                onPageChange: '&?'\n            },\n            link: function(scope, element, attrs) {\n                var paginationId;\n                paginationId = attrs.paginationId || '__default';\n                if (!scope.maxSize) { scope.maxSize = 9; }\n                scope.directionLinks = angular.isDefined(attrs.directionLinks) ? scope.$parent.$eval(attrs.directionLinks) : true;\n                scope.boundaryLinks = angular.isDefined(attrs.boundaryLinks) ? scope.$parent.$eval(attrs.boundaryLinks) : false;\n\n                if (!paginationService.isRegistered(paginationId)) {\n                    var idMessage = (paginationId !== '__default') ? ' (id: ' + paginationId + ') ' : ' ';\n                    throw 'pagination directive: the pagination controls' + idMessage + 'cannot be used without the corresponding pagination directive.';\n                }\n\n                var paginationRange = Math.max(scope.maxSize, 5);\n                scope.pages = [];\n                scope.pagination = {\n                    last: 1,\n                    current: 1\n                };\n\n                scope.$watch(function() {\n                    return (paginationService.getCollectionLength(paginationId) + 1) * paginationService.getItemsPerPage(paginationId);\n                }, function(length) {\n                    if (0 < length) {\n                        generatePagination();\n                    }\n                });\n\n                scope.$watch(function() {\n                    return paginationService.getCurrentPage(paginationId);\n                }, function(currentPage, previousPage) {\n                    if (currentPage != previousPage) {\n                        goToPage(currentPage);\n                    }\n                });\n\n                scope.setCurrent = function(num) {\n                    if (isValidPageNumber(num)) {\n                        paginationService.setCurrentPage(paginationId, num);\n                    }\n                };\n\n                function goToPage(num) {\n                    if (isValidPageNumber(num)) {\n                        scope.pages = generatePagesArray(num, paginationService.getCollectionLength(paginationId), paginationService.getItemsPerPage(paginationId), paginationRange);\n                        scope.pagination.current = num;\n\n                        // if a callback has been set, then call it with the page number as an argument\n                        if (scope.onPageChange) {\n                            scope.onPageChange({ newPageNumber : num });\n                        }\n                    }\n                }\n\n                function generatePagination() {\n                    var page = parseInt(paginationService.getCurrentPage(paginationId)) || 1;\n\n                    scope.pages = generatePagesArray(page, paginationService.getCollectionLength(paginationId), paginationService.getItemsPerPage(paginationId), paginationRange);\n                    scope.pagination.current = page;\n                    scope.pagination.last = scope.pages[scope.pages.length - 1];\n                    if (scope.pagination.last < scope.pagination.current) {\n                        scope.setCurrent(scope.pagination.last);\n                    }\n                }\n\n                function isValidPageNumber(num) {\n                    return (numberRegex.test(num) && (0 < num && num <= scope.pagination.last));\n                }\n            }\n        };\n    }]);\n\n    module.filter('itemsPerPage', ['paginationService', function(paginationService) {\n        return function(collection, itemsPerPage, paginationId) {\n            if (typeof (paginationId) === 'undefined') {\n                paginationId = '__default';\n            }\n            if (!paginationService.isRegistered(paginationId)) {\n                throw 'pagination directive: the itemsPerPage id argument (id: ' + paginationId + ') does not match a registered pagination-id.';\n            }\n            var end;\n            var start;\n            if (collection instanceof Array) {\n                itemsPerPage = parseInt(itemsPerPage) || 9999999999;\n                if (paginationService.isAsyncMode(paginationId)) {\n                    start = 0;\n                } else {\n                    start = (paginationService.getCurrentPage(paginationId) - 1) * itemsPerPage;\n                }\n                end = start + itemsPerPage;\n                paginationService.setItemsPerPage(paginationId, itemsPerPage);\n\n                return collection.slice(start, end);\n            } else {\n                return collection;\n            }\n        };\n    }]);\n\n    module.service('paginationService', function() {\n        var instances = {};\n        var lastRegisteredInstance;\n\n        this.registerInstance = function(instanceId) {\n            if (typeof instances[instanceId] === 'undefined') {\n                instances[instanceId] = {\n                    asyncMode: false\n                };\n                lastRegisteredInstance = instanceId;\n            }\n        };\n\n        this.isRegistered = function(instanceId) {\n            return (typeof instances[instanceId] !== 'undefined');\n        };\n\n        this.getLastInstanceId = function() {\n            return lastRegisteredInstance;\n        };\n\n        this.setCurrentPageParser = function(instanceId, val, scope) {\n            instances[instanceId].currentPageParser = val;\n            instances[instanceId].context = scope;\n        };\n        this.setCurrentPage = function(instanceId, val) {\n            instances[instanceId].currentPageParser.assign(instances[instanceId].context, val);\n        };\n        this.getCurrentPage = function(instanceId) {\n            var parser = instances[instanceId].currentPageParser;\n            return parser ? parser(instances[instanceId].context) : 1;\n        };\n\n        this.setItemsPerPage = function(instanceId, val) {\n            instances[instanceId].itemsPerPage = val;\n        };\n        this.getItemsPerPage = function(instanceId) {\n            return instances[instanceId].itemsPerPage;\n        };\n\n        this.setCollectionLength = function(instanceId, val) {\n            instances[instanceId].collectionLength = val;\n        };\n        this.getCollectionLength = function(instanceId) {\n            return instances[instanceId].collectionLength;\n        };\n\n        this.setAsyncModeTrue = function(instanceId) {\n            instances[instanceId].asyncMode = true;\n        };\n\n        this.isAsyncMode = function(instanceId) {\n            return instances[instanceId].asyncMode;\n        };\n    });\n})();\n","'use strict';\n\nangular.module('videoHub')\n  .directive('deliveryChart', function() {\n    return {\n      restrict: 'E',\n      templateUrl: 'shared/chart/chart.html',\n      scope: {\n        impressions: '@impressions'\n      },\n      //Setting up Highcharts options\n      controller: function($scope) {\n        $scope.semiCircleConfig = {\n          options: {\n            chart: {\n              type: 'pie',\n              backgroundColor: 'transparent',\n              height: 75,\n              margin: 0,\n              width: 75,\n            },\n            exporting: { enabled: false },\n            credits: { enabled: false },\n            tooltip: { enabled: false },\n            colors: ['#008d52', '#e2e2e2'],\n          },\n          series: [{\n            dataLabels: { enabled: false },\n            states: {\n              hover: {\n                 enabled: false\n              }\n            },\n            animation: false,\n            startAngle: -90,\n            endAngle: 90,\n            center: ['50%', '75%'],\n            innerSize: '50%',\n            name: 'Delivery',\n            data: [\n              parseInt($scope.impressions),\n              (100 - parseInt($scope.impressions))\n            ]\n          }],\n          title: {\n            text: ''\n          },\n          subtitle: {\n            text: ''\n          },\n          loading: false\n        };\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n\t.filter('convertToLocal', function() {\n    return function (input) {\n      if (input) {\n        return moment.utc(input).local().format('YYYY-MM-DD hh:mm A');\n      }\n      return input;\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .constant('DatetimePickerConstants', {\n    'DATETIME_PICKER_FORMAT': 'Y-m-d h:i A',\n    'MOMENTJS_FORMAT': 'YYYY-MM-DDTHH:mm:DDZZ'\n  })\n  .directive('datetimepicker', ['$filter', 'DatetimePickerConstants', function($filter, DatetimePickerConstants) {\n    return {\n      scope: {\n        'date': '='\n      },\n      replace: true,\n      require:'ngModel',\n      template: '<input class=\"form-control\" ng-model=\"date\" type=\"text\"/>',\n      link: function(scope, element, attrs, ngModel){\n        scope.required = attrs.required || false;\n        element.datetimepicker({\n          format: DatetimePickerConstants.DATETIME_PICKER_FORMAT,\n          startDate: new Date(),\n          step: 15\n          });\n\n        function convertToLocal(value){\n          return $filter('convertToLocal')(value);\n        }\n\n        ngModel.$formatters.unshift(convertToLocal);\n\n        scope.formatDateForBackend = function(value){\n          if (value){\n            return moment(value, DatetimePickerConstants.DATETIME_PICKER_FORMAT).format(DatetimePickerConstants.MOMENTJS_FORMAT);\n          }\n        };\n\n        ngModel.$parsers.unshift(scope.formatDateForBackend);\n      }\n    };\n  }]);\n","'use strict';\nangular.module('videoHub')\n  .service('ListService', function($rootScope, $location, $injector, ValidQueryParamsForListPage) {\n    this.data = {};\n    var ListService = this;\n    this.service = null;\n    var currentService = null;\n\n    this.setService = function(serviceName){\n      this.service = $injector.get(serviceName);\n      currentService = this.service;\n      this.data.list = [];\n      this.data.totalItems = [];\n    };\n\n    this.setList = function(list) {\n      ListService.data.list = list;\n      ListService.data.totalItems = list.count;\n    };\n\n    this.updateList = function() {\n      var params = $location.search();\n      params = _.pick(params, ValidQueryParamsForListPage);\n      return currentService.getList(params).then(ListService.setList);\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .directive('navBar', function() {\n    return {\n        'restrict': 'E',\n        'templateUrl': 'shared/navbar/navbar.html',\n        'controller': function($scope, $rootScope, logoUrl, $location, NavBarConfigService, CurrentUser) {\n            $scope.searchTerm = $location.search().search || '';\n            $scope.logoUrl = logoUrl;\n            $scope.config = NavBarConfigService.config;\n\n            $scope.search = function(){\n              $location.search('q', $scope.searchTerm);\n              NavBarConfigService.config.updateList();\n            };\n\n            $scope.clearSearch = function(){\n              NavBarConfigService.config.updateList();\n              $scope.searchTerm = '';\n              $location.search('q', null);\n            };\n\n            CurrentUser.$simplified().then(function(data){\n              $scope.currentUserName = data.displayName;\n            });\n\n        }\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .service('NavBarConfigService', function(){\n    this.config = {};\n    this.config.showSearchBar = false;\n    this.setShowSearchBar = function(flag){\n      this.config.showSearchBar = flag;\n    };\n    this.config.updateList = null;\n    this.setUpdateListFunction = function(func){\n      this.config.updateList = func;\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n\t.filter('placeholder', function(placeholderUrl) {\n    return function (input) {\n      if (input) {\n        return input;\n      } else {\n        return placeholderUrl;\n      }\n    };\n  });\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('VideoService',\nfunction(Restangular) {\n  return Restangular.service('videos');\n});\n","'use strict';\nangular.module('videoHub')\n  .directive('autocomplete', function($injector) {\n    return {\n      templateUrl: 'shared/autocomplete/autocomplete.html',\n      scope: {\n        'ngModel': '=',\n        'service': '@service',\n        'labelAttr': '@',\n        'placeholderText': '@'\n      },\n      controller: function($scope) {\n        //Inject service based on provided value\n        var service = $injector.get($scope.service);\n        //Debounce the search to avoid spamming requests\n        $scope.$watch('search', function() {\n          if ($scope.modelSelected || $scope.showDropdown || _.isEmpty($scope.search)) {\n            return;\n          } else {\n            service.getList().then(updateCurrentModelsAndDisplayDropdown);\n          }\n        });\n\n        function updateCurrentModelsAndDisplayDropdown(data) {\n          if (!_.isUndefined(data)) {\n            $scope.currentModels = data;\n            if (_.isUndefined($scope.modelSelected)) {\n              $scope.modelSelected = false;\n            }\n            $scope.showDropdown = $scope.currentModels && !$scope.modelSelected;\n          } else {\n            $scope.currentModels = null;\n            $scope.showDropdown = false;\n          }\n        }\n\n        $scope.selectedElement = 0;\n        $scope.controlSelectedElementWithKeyboard = function(event) {\n          var keyCode = event.keyCode;\n          if ($scope.currentModels) {\n            var lastIndexOfCurrentModels = $scope.currentModels.length - 1;\n            switch (keyCode) {\n              case 27: // ESC\n                $scope.toggleDropdownStatus();\n                break;\n              case 40: // DOWN\n                $scope.selectedElement = $scope.selectedElement === lastIndexOfCurrentModels ?\n                  0 :\n                  $scope.selectedElement + 1;\n                break;\n              case 38: // UP\n                $scope.selectedElement = $scope.selectedElement === 0 ?\n                  lastIndexOfCurrentModels :\n                  $scope.selectedElement - 1;\n                break;\n              case 13: // RETURN\n                $scope.setModel($scope.currentModels[$scope.selectedElement]);\n                $scope.selectedElement = 0;\n                break;\n              default:\n                return;\n            }\n          }\n\n        };\n\n        // ngModel is not always populated when the directive initializes. if this happens, $scope.search is not set to ngModel[$scope.labelAttr]\n        // Additionally, the dialog does not lock. In order to avoid this from happening, we watch ngModel, and set ngModel when it loads.\n        $scope.$watch('ngModel', function(newValue) {\n          if (newValue) {\n            $scope.setModel(newValue);\n          }\n        });\n\n        $scope.toggleDropdownStatus = function() {\n          $scope.showDropdown = false;\n          $scope.selectedElement = 0;\n          if (!_.isUndefined($scope.ngModel)) {\n            $scope.modelSelected = !$scope.modelSelected;\n            $scope.search = $scope.ngModel[$scope.labelAttr];\n          } else {\n            $scope.modelSelected = false;\n            $scope.search = '';\n          }\n        };\n\n        $scope.setModel = function(model) {\n          $scope.ngModel = model;\n          $scope.search = model[$scope.labelAttr];\n          if ($scope.currentModels) {\n            $scope.currentModels = null;\n          }\n          $scope.modelSelected = true;\n          $scope.showDropdown = false;\n          $scope.selectedElement = 0;\n        };\n\n        if ($scope.ngModel) {\n          $scope.setModel($scope.ngModel);\n          $scope.modelSelected = true;\n        }\n      }\n    };\n  });\n","'use strict';\n(function () {\n  angular.module('BettyCropper', ['restangular'])\n    .value('DEFAULT_IMAGE_WIDTH', 1200)\n    .factory('Selection', SelectionFactory)\n    .factory('BettyImage', BettyImageFactory)\n    .service('BettyCropper', BettyCropperService);\n\n  function BettyCropperService($http, $interpolate, $q, IMAGE_SERVER_URL, BC_API_KEY, BettyImage) {\n      var fileInputId = '#bulbs-cms-hidden-image-file-input';\n      var inputTemplate = '<input id=\"bulbs-cms-hidden-image-file-input\" type=\"file\" accept=\"image/*\" style=\"position: absolute; left:-99999px;\" name=\"image\" />';\n\n      this.upload = upload;\n      this.get = get;\n      this.detail = get;\n      this.detailPatch = detailPatch;\n      this.updateSelection = updateSelection;\n\n      function upload() {\n        var uploadImageDeferred = $q.defer();\n\n        angular.element(fileInputId).remove();\n        var fileInput = angular.element(inputTemplate);\n        angular.element('body').append(fileInput);\n\n        fileInput.click();\n\n        fileInput.unbind('change');\n        fileInput.bind('change', function (e) {\n          if (e.target.files.length !== 1) {\n            uploadImageDeferred.reject('We need exactly one image!');\n          }\n          var file = e.target.files[0];\n          if (file.type.indexOf('image/') !== 0) {\n            uploadImageDeferred.reject('Not an image!');\n          }\n\n          if (file.size > 10 * 1024 * 1024) { // MAGIC!\n            uploadImageDeferred.reject('The file is too large!');\n          }\n\n          var imageData = new FormData();\n          imageData.append('image', file);\n\n          $http({\n            method: 'POST',\n            url: IMAGE_SERVER_URL + '/api/new',\n            headers: {\n              'X-Betty-Api-Key': BC_API_KEY,\n              'Content-Type': undefined,\n              'X-CSRFToken': undefined\n            },\n            data: imageData,\n            transformRequest: angular.identity,\n            transformResponse: function (data, headersGetter) {\n              // So, sometimes the browser doesn't think that JSON data is JSON.\n              if (typeof data === 'string') {\n                data = $.parseJSON(data);\n              }\n              var image = new BettyImage(data);\n              return image;\n            }\n          }).success(function (success) {\n            uploadImageDeferred.resolve(success);\n          }).error(function (error) {\n            uploadImageDeferred.reject(error);\n          });\n\n        });\n\n        return uploadImageDeferred.promise;\n      }\n\n      function get(id) {\n        return $http({\n          method: 'GET',\n          url: IMAGE_SERVER_URL + '/api/' + id,\n          headers: {\n            'X-Betty-Api-Key': BC_API_KEY,\n            'Content-Type': undefined,\n            'X-CSRFToken': undefined\n          },\n          transformRequest: angular.identity,\n          transformResponse: function (data, headersGetter) {\n            if (typeof data === 'string') {\n              data = $.parseJSON(data);\n            }\n            return new BettyImage(data);\n          }\n        });\n      }\n\n      function detailPatch(id, name, credit, selections) {\n        return $http({\n          method: 'PATCH',\n          url: IMAGE_SERVER_URL + '/api/' + id,\n          headers: {\n            'X-Betty-Api-Key': BC_API_KEY,\n            'Content-Type': undefined,\n            'X-CSRFToken': undefined\n          },\n          data: {\n            name: name,\n            credit: credit,\n            selections: selections\n          },\n          transformRequest: angular.identity,\n          transformResponse: function (data, headersGetter) {\n            if (typeof data === 'string') {\n              data = $.parseJSON(data);\n            }\n            return new BettyImage(data);\n          }\n        });\n      }\n\n      function updateSelection(id, ratio, selections) {\n        return $http({\n          method: 'POST',\n          url: IMAGE_SERVER_URL + '/api/' + id + '/' + ratio,\n          headers: {\n            'X-Betty-Api-Key': BC_API_KEY,\n            'Content-Type': undefined,\n            'X-CSRFToken': undefined\n          },\n          data: selections\n        });\n      }\n  }\n\n  function BettyImageFactory($interpolate, $http, IMAGE_SERVER_URL, BC_API_KEY, DEFAULT_IMAGE_WIDTH, Selection) {\n    function BettyImage(data) {\n      this.id = data.id;\n      this.name = data.name;\n      this.width = data.width;\n      this.height = data.height;\n      this.selections = {};\n      for (var ratio in data.selections) {\n        this.selections[ratio] = new Selection(data.selections[ratio]);\n      }\n    }\n\n    BettyImage.prototype.scaleToFit = function(width, height) {\n      var scale;\n      if (width && height) {\n        var fitRatio = width / height;\n        var thisRatio = this.width / this.height;\n        if (fitRatio > thisRatio) {\n          scale = height/ this.height;\n        } else {\n          scale = width / this.width;\n        }\n      } else {\n        if (width) {\n          scale = width / this.width;\n        }\n        if (height) {\n          scale = height/ this.height;\n        }\n      }\n      var scaled = {\n        width: Math.round(this.width * scale),\n        height: Math.round(this.height * scale),\n        scale: scale\n      };\n      return scaled;\n    };\n\n    BettyImage.prototype.getStyles = function(width, height, ratio) {\n      if (height === 0) {\n        height = null;\n      }\n\n      var selection = this.selections[ratio];\n      var scaledSelection = selection.scaleToFit(width, height);\n\n      return {\n        'background-image': 'url(' + this.url('original', DEFAULT_IMAGE_WIDTH, 'jpg') + ')',\n        'background-size': Math.floor(scaledSelection.width() / selection.width()  * this.width) + 'px',\n        'background-position': '-' + scaledSelection.x0 + 'px -' + scaledSelection.y0 + 'px',\n        'height': scaledSelection.height() + 'px',\n        'width': scaledSelection.width() + 'px',\n        'background-repeat': 'no-repeat',\n        'position': 'relative'\n      };\n    };\n\n    BettyImage.prototype.url = function (ratio, width, format) {\n      var exp = $interpolate(\n        '{{ base_url }}/{{ id }}/{{ ratio }}/{{ width }}.{{ format }}'\n      );\n      var idStr = this.id.toString();\n      var segmentedId = '';\n      for (var i=0; i < idStr.length; i++) {\n        if (i % 4 === 0 && i !== 0) {\n          segmentedId += '/';\n        }\n        segmentedId += idStr.substr(i, 1);\n      }\n      return exp({\n        base_url: IMAGE_SERVER_URL,\n        id: segmentedId,\n        ratio: ratio,\n        width: width,\n        format: format\n      });\n    };\n\n    BettyImage.prototype.updateSelection = function (ratio, selection) {\n      var data = {\n        x0: selection.x0,\n        x1: selection.x1,\n        y0: selection.y0,\n        y1: selection.y1\n      };\n      if (selection.source) {\n        data.source = selection.source;\n      }\n      return $http({\n        method: 'POST',\n        url: IMAGE_SERVER_URL + '/api/' + this.id + '/' + ratio,\n        headers: {\n          'X-Betty-Api-Key': BC_API_KEY,\n          'Content-Type': undefined,\n          'X-CSRFToken': undefined\n        },\n        data: data,\n        transformResponse: function (data, headersGetter) {\n          if (typeof data === 'string') {\n            data = $.parseJSON(data);\n          }\n          return [ratio, new Selection(data.selections[ratio])];\n        }\n      });\n    };\n\n    return BettyImage;\n  }\n\n  function SelectionFactory() {\n    function Selection(data) {\n        this.x0 = data.x0;\n        this.x1 = data.x1;\n        this.y0 = data.y0;\n        this.y1 = data.y1;\n        this.source = data.source;\n    }\n\n    Selection.prototype.width = function () {\n      return this.x1 - this.x0;\n    };\n\n    Selection.prototype.height = function () {\n      return this.y1 - this.y0;\n    };\n\n    Selection.prototype.scaleBy = function(scale) {\n      var scaledToFit = new Selection({\n        x0: Math.round(this.x0 * scale),\n        x1: Math.round(this.x1 * scale),\n        y0: Math.round(this.y0 * scale),\n        y1: Math.round(this.y1 * scale)\n      });\n      return scaledToFit;\n    };\n\n    Selection.prototype.scaleToFit = function (width, height) {\n\n      var scale;\n      if (width && height) {\n        var fitRatio = width / height;\n        var thisRatio = this.width() / this.height();\n        if (fitRatio > thisRatio) {\n          scale = height/ this.height();\n        } else {\n          scale = width / this.width();\n        }\n      } else {\n        if (width) {\n          scale = width / this.width();\n        }\n        if (height) {\n          scale = height/ this.height();\n        }\n      }\n      return this.scaleBy(scale);\n    };\n\n    return Selection;\n  }\n})();\n","'use strict';\n\nangular.module('videoHub')\n  .directive('bettyeditable', function($http, BettyCropper, openImageCropModal) {\n    return {\n      restrict: 'E',\n      templateUrl: 'shared/bettycropper/bettyeditable.html',\n      scope: {\n        'image': '=',\n        'addStyles': '@',\n        'placeholderText': '@',\n        'hideMetas': '=',\n        'ratio': '@',\n        'editable': '=?'\n      },\n      controller: function($scope, $element) {\n        $scope.editable = angular.isDefined($scope.editable) ? $scope.editable : true;\n        $scope.upload = function(e) {\n          BettyCropper.upload().then(\n            function(success) {\n              $scope.image = {\n                id: success.id,\n                caption: null,\n                alt: null\n              };\n              $scope.bettyImage = success;\n            },\n            function(error) {\n              console.log(error);\n            },\n            function(progress) {\n              console.log(progress);\n            }\n          );\n        };\n\n        $scope.edit = function(e) {\n          openImageCropModal($scope.image).then(function(image) {\n            if (image.id === null) {\n              $scope.image = null;\n            } else {\n              $scope.image = image;\n              BettyCropper.get($scope.image.id).then(function(response) {\n                $scope.bettyImage = response.data;\n                $scope.setStyles();\n              });\n            }\n          });\n        };\n      },\n\n      link: function(scope, element, attrs) {\n\n        if (scope.bettyImage === undefined) {\n          scope.bettyImage = null;\n        }\n\n        scope.setStyles = function() {\n          if (scope.bettyImage) {\n            scope.imageStyling = scope.bettyImage.getStyles(element.parent().width(), element.parent().height(), scope.ratio);\n          } else {\n            var ratioWidth = parseInt(scope.ratio.split('x')[0], 10);\n            var ratioHeight = parseInt(scope.ratio.split('x')[1], 10);\n            scope.imageStyling = {\n              'background-color': '#333',\n              'position': 'relative',\n              'width': element.parent().width(),\n              'height': Math.floor(element.parent().width() * ratioHeight / ratioWidth) + 'px',\n            };\n          }\n        };\n\n        scope.$watch('image', function(newImage, oldImage) {\n          if (newImage && newImage.id) {\n            BettyCropper.get(newImage.id).then(function(response) {\n              scope.bettyImage = response.data;\n            });\n          }\n        });\n\n        scope.$watch('bettyImage', function(newImage, oldImage) {\n          scope.setStyles();\n        }, true);\n\n        element.resize(scope.setStyles);\n\n        scope.removeImage = function() {\n          scope.image.id = null;\n        };\n\n        scope.editImage = function() {\n          openImageCropModal(scope.image)\n            .then(function(success) {\n              console.log(success);\n            });\n        };\n\n      }\n    };\n  });\n","'use strict';\n\nangular.module('BettyCropper')\n  .controller('ImageCropModalCtrl', function ($scope, $timeout, $modalInstance, BettyCropper, Selection, DEFAULT_IMAGE_WIDTH, imageData, ratios) {\n    $scope.selectedCrop = null;\n    $scope.cropMode = false;\n    $scope.ratios = ratios;\n    $scope.finished = false;\n    $scope.thumb_container_styles = {};\n    $scope.imageData = imageData;\n\n    if (!$scope.image) {\n      $scope.image = null;\n      BettyCropper.get(imageData.id).then(function(success){\n        $scope.image = success.data;\n      });\n    }\n\n    $scope.$watch('image', function (image) {\n      if (!image) {\n        return;\n      }\n\n      var finished = true;\n      for (var ratio in image.selections) {\n        if (image.selections[ratio].source === 'auto') {\n          finished = false;\n          break;\n        }\n      }\n      $scope.finished = finished;\n\n      $scope.scaleData = image.scaleToFit(550, 400);\n\n      $('.crop-image-container img').one('load', function () {\n        $(this).Jcrop({\n          allowSelect: false,\n          allowMove: true,\n          allowResize: true,\n          keySupport: false\n        }, function () {\n          $scope.jcrop_api = this;\n        });\n      });\n\n      $scope.image_url = image.url('original', DEFAULT_IMAGE_WIDTH, 'jpg');\n      if (!$scope.ratios) {\n        $scope.ratios = Object.keys(image.selections);\n      }\n\n      $scope.setThumbStyles();\n    });\n\n    $scope.$watch('selectedCrop', function(crop) {\n      if (!$scope.image) {\n        return;\n      }\n      var finished = true;\n      for (var ratio in $scope.image.selections) {\n        if ($scope.image.selections[ratio].source === 'auto' && ratio !== crop) {\n          finished = false;\n          break;\n        }\n      }\n      $scope.finished = finished;\n    });\n\n    $scope.selectCrop = function (ratio) {\n      if (!ratio) {\n        ratio = Object.keys($scope.image.selections)[0];\n        for (var key in $scope.image.selections) {\n          if ($scope.image.selections[key].source === 'auto') {\n            ratio = key;\n            break;\n          }\n        }\n      }\n      var selection = $scope.image.selections[ratio].scaleBy($scope.scaleData.scale);\n\n      $scope.jcrop_api.setOptions({\n        aspectRatio: selection.width() / selection.height()\n      });\n\n      $scope.jcrop_api.setSelect([\n        selection.x0,\n        selection.y0,\n        selection.x1,\n        selection.y1\n      ]);\n\n      $scope.cropMode = true;\n      $scope.selectedCrop = ratio;\n    };\n\n    $scope.setThumbStyles = function () {\n      $scope.thumb_styles = $scope.thumb_styles || {};\n\n      for (var ratio in $scope.image.selections) {\n        var scaledSelection = $scope.image.selections[ratio].scaleToFit(170, 170);\n        $scope.thumb_container_styles[ratio] = {\n          'padding-top': Math.round((180 - scaledSelection.height()) / 2) + 'px',\n          'padding-bottom': '5px',\n          'padding-left':  Math.round((180 - scaledSelection.width()) / 2) + 'px',\n          'padding-right': '5px'\n        };\n\n        $scope.thumb_styles[ratio] = $scope.image.getStyles(170, 170, ratio);\n      }\n    };\n\n    $scope.save = function (ratio) {\n\n      var jcrop_selection = $scope.jcrop_api.tellSelect();\n\n      var newSelection = new Selection({\n        x0: jcrop_selection.x,\n        x1: jcrop_selection.x2,\n        y0: jcrop_selection.y,\n        y1: jcrop_selection.y2,\n        source: 'user'\n      });\n      newSelection = newSelection.scaleBy(1 / $scope.scaleData.scale);\n      if (newSelection.x1 > $scope.image.width) {\n        newSelection.x1 = $scope.image.width;\n      }\n      if (newSelection.y1 > $scope.image.height) {\n        newSelection.y1 = $scope.image.height;\n      }\n\n      return this.image.updateSelection(ratio, newSelection);\n    };\n\n    $scope.saveAndQuit = function () {\n      var ratio = $scope.selectedCrop;\n      this.save(ratio).then(function (success) {\n        var ratio = success.data[0];\n        var selection = success.data[1];\n        $scope.image.selections[ratio] = selection;\n      });\n      $scope.cropMode = false;\n      $modalInstance.close(imageData);\n    };\n\n    $scope.saveAndNext = function () {\n      var ratio = $scope.selectedCrop;\n      this.save(ratio).then(function (success) {\n        var ratio = success.data[0];\n        var selection = success.data[1];\n        $scope.image.selections[ratio] = selection;\n\n        var nextRatioIndex = ($scope.ratios.indexOf(ratio) + 1) % $scope.ratios.length;\n\n        $scope.selectCrop($scope.ratios[nextRatioIndex]);\n      });\n    };\n\n  });\n","'use strict';\n\nangular.module('BettyCropper')\n  .factory('openImageCropModal', function ($modal) {\n    var openImageCropModal = function (imageData, ratios) {\n\n      return $modal.open({\n        templateUrl: 'shared/bettycropper/image-crop-modal.html',\n        controller: 'ImageCropModalCtrl',\n        resolve: {\n          imageData: function () { return imageData; },\n          ratios: function () { return ratios || false; }\n        },\n        backdrop: 'static'\n      }).result;\n\n    };\n\n    return openImageCropModal;\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .service('CurrentUser', function EditorItems(Restangular, $q) {\n\n    var userDefer = $q.defer(),\n      $userPromise = userDefer.promise;\n\n    this.data = [];\n\n    var self = this;\n    this.getItems = function() {\n      Restangular.one('me').get().then(function(data) {\n        self.data = data;\n        userDefer.resolve(data);\n      });\n    };\n\n    this.getItems();\n\n    /**\n     * Get promise that resolves when user data is populated.\n     */\n    this.$retrieveData = function() {\n      return $userPromise;\n    };\n\n    /**\n     * Create a simplified version of this user for storage.\n     */\n    this.$simplified = function() {\n\n      return $userPromise.then(function(user) {\n\n        var displayName = user.first_name && user.last_name ?\n          user.first_name + ' ' + user.last_name :\n          (user.email || user.username);\n\n        return {\n          id: user.id,\n          displayName: displayName\n        };\n\n      });\n\n    };\n\n  });\n"]}