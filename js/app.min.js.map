{"version":3,"file":"app.min.js","sources":["../../app/app.js","../../app/components/detail-pages/channeldetail/channeldetail-controller.js","../../app/components/detail-pages/seriesdetail/seriesdetail-controller.js","../../app/components/detail-pages/slider-detail/slider-detail-controller.js","../../app/components/detail-pages/slider-detail/slider-detail-slide/slider-detail-slide-directive.js","../../app/components/detail-pages/sponsordetail/sponsordetail-controller.js","../../app/components/detail-pages/videodetail/channelselection/channelselection-directive.js","../../app/components/detail-pages/videodetail/channelselection/dropdownfilter-service.js","../../app/components/detail-pages/videodetail/videodetail-controller.js","../../app/components/detail-pages/videodetail/videofield/videofield-directive.js","../../app/components/detail-pages/videodetail/videofield/zencoder-service.js","../../app/components/list-pages/channellist/channellist-controller.js","../../app/components/list-pages/serieslist/serieslist-controller.js","../../app/components/list-pages/slider-list/slider-list-controller.js","../../app/components/list-pages/sponsorlist/sponsorlist-controller.js","../../app/components/list-pages/videolist/videolist-controller.js","../../app/components/login/login-controller.js","../../app/shared/alert/alert-directive.js","../../app/shared/alert/alert-service.js","../../app/shared/api/channel-service.js","../../app/shared/api/season-service.js","../../app/shared/api/series-service.js","../../app/shared/api/slider-service.js","../../app/shared/api/slides-service.js","../../app/shared/api/sponsor-service.js","../../app/shared/api/tags-service.js","../../app/shared/api/video-service.js","../../app/shared/auth/tokenauth-service.js","../../app/shared/autocomplete/autocomplete-directive.js","../../app/shared/bettycropper/betty-cropper.js","../../app/shared/bettycropper/bettyeditable.js","../../app/shared/bettycropper/imagecropmodal.js","../../app/shared/bettycropper/openimagecropmodal.js","../../app/shared/converttolocal/converttolocal-filter.js","../../app/shared/create-content/create-content.js","../../app/shared/currentuser/currentuser-service.js","../../app/shared/date-time-selector/date-time-selector-directive.js","../../app/shared/date-time-selector/date-time-selector-formatter-filter.js","../../app/shared/date-time-selector/date-time-selector-modal-controller.js","../../app/shared/delete-modal/delete-modal-controller.js","../../app/shared/delete-modal/deletemodal-directive.js","../../app/shared/detailsnavbar/detailsnavbar-directive.js","../../app/shared/detailsnavbar/save-button-state-service.js","../../app/shared/dropdownselector/dropdownselector-directive.js","../../app/shared/filter-buttons/filter-buttons-directive.js","../../app/shared/list-page-column/list-page-column-directive.js","../../app/shared/listnavbar/listnavbar-directive.js","../../app/shared/listservice/list-service.js","../../app/shared/nav-dropdown/nav-dropdown-directive.js","../../app/shared/pagination/dirPagination.js","../../app/shared/sponsor-selection-modal/sponsor-selection-modal-controller.js","../../app/shared/sponsor-selection-modal/sponsormodal-directive.js","../../app/shared/tags-autocomplete/tags-autocomplete-directive.js","../../app/shared/tz-date-filter/tz-date-filter.js","../../app/shared/videoplayer/videoplayer-directive.js"],"names":["angular","module","constant","window","moment","$","config","RestangularProvider","setBaseUrl","addResponseInterceptor","data","operation","results","meta","count","prev","next","isoDatesToMoments","obj","_","has","published","isArray","each","momentsToIsoDates","isMoment","format","addRequestInterceptor","element","$locationProvider","$httpProvider","$routeProvider","$sceDelegateProvider","resourceUrlWhitelist","html5Mode","when","templateUrl","controller","reloadOnSearch","otherwise","redirectTo","SAVED_ALERT_MESSAGE","SOMETHING_WENT_WRONG_ALERT_MESSAGE","PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE","DELETE_SUCCESSFUL","$scope","$routeParams","ChannelService","$location","AlertService","DetailPageControllerConstants","Restangular","SaveButtonStateService","validateAccentColorFields","input","displaySomethingWentWrongAlert","error","channel","fields","accent_color","getChannel","one","channelId","get","then","partner","accentColorStringAsArray","words","length","r","parseInt","g","b","console","log","restangularizeElement","save","channelDetailForm","$valid","id","getRGBValueFromFields","successCallback","$error","compiled","template","params","$setPristine","displaySavingAnimation","path","$watch","newValue","dateTimeSelectorCallback","newDate","delete","info","SeriesService","series","getSeries","seriesId","dropdownFields","sponsor","isUndefined","seriesDetailForm","isEmpty","$q","SliderService","normalizeSlideIndicies","slider","slides","slide","i","position","$getSlider","sliderId","catch","sortableOptions","containment","opacity","placeholder","stop","sliderDetailForm","$setDirty","addSlide","push","removeSlide","findIndex","splice","$saveSlider","promise","directive","restrict","scope","removeFunction","parentForm","SponsorService","hideDatetimeSelectionModal","getSponsor","sponsorId","sponsorDetailForm","newSponsor","DropdownFilterService","transclude","link","channelFieldChanged","setChannel","seriesFieldChanged","setSeries","populateChannelList","service","SeasonService","this","filter","newChannel","updateFilter","populateSeriesList","clear","newSeries","populateSeasonList","season","setSeason","newSeason","setChannelList","channelList","getList","page_size","f","seriesList","seasonList","VideoService","video","getVideo","videoId","setVideo","tags","tagObjects","pluck","videoDetailForm","remove","success","FILE_TOO_LARGE_ERROR_MESSAGE","MUST_UPLOAD_FILES_ERROR_MESSAGE","PLEASE_SELECT_A_FILE_ERROR_MESSAGE","UPLOAD_COMPLETE_SUCCESS_MESSAGE","Zencoder","$timeout","VideoFieldConstants","uploadVideo","fileField","unbind","bind","event","file","target","files","validateVideoFile","addVideo","uploadToS3AndEncode","encodingProgress","fetchNewVideoObject","e","loaded","uploadProgress","Math","round","total","progress","click","validateVideoFileDeferred","defer","size","reject","type","indexOf","resolve","addVideoDeferred","doGET","encodingPayload","encoding_payload","uploadToS3Arguments","videoObject","checkIfSourcesHaveLoadedAndRetryIfTheyAreNot","response","sources","UPLOAD_TO_S3_PROGRESS_MESSAGE","UPLOAD_TO_S3_UPLOAD_BEGINNING_MESSAGE","UPLOAD_TO_S3_UPLOAD_COMPLETE_MESSAGE","UPLOAD_TO_S3_UPLOAD_FAILED_MESSAGE","ENCODE_FAILED_MESSAGE","ENCODE_PROGRESS_MESSAGE","$http","$interval","ZencoderConstants","uploadToS3","s3Config","s3deferred","formData","FormData","append","key","AWSAccessKeyId","acl","success_action_status","policy","signature","xhr","XMLHttpRequest","open","upload_endpoint","upload","onprogress","notify","onload","addEventListener","send","encode","encodeDeferred","doPOST","zencoderProgressEndpoint","json","progressInterval","url","method","ignoreAuthorizationHeader","state","cancel","uploadToS3AndEncodeDeferred","errorCallback","notifyCallback","$rootScope","ListService","setService","update","list","totalItems","getParams","updateList","changeToEditPage","setOrderAndUpdateList","newOrderValue","setOrder","clearSearchAndUpdateList","clearSearch","pageChanged","newPageNumber","setPage","selectSearchBox","focus","setSearchAndUpdateList","setSearch","q","sliders","setFilterAndUpdateList","newFilterValue","setFilter","new","authService","showSearchBar","showSaveButton","username","password","submitLogin","login","alertStatus","TIME_TO_WAIT_BEFORE_CLEARING","AlertServiceConstants","clearAfterDisplayingMessageFlag","setAlertStatusElementsToFalse","alertDeferred","alertService","message","factory","$injector","httpRequestBuffer","localStorageService","request","headers","token","isBettyCropperRequest","Authorization","responseError","ignoreAuthModule","status","deferred","refreshToken","interceptors","CurrentUser","_login","post","set","setCurrentUser","_refreshToken","retryAll","rejectAll","_retryHttpRequest","buffer","reason","replace","model","labelAttr","placeholderText","attrs","isRequired","doSearchAndUpdateCurrentModels","modelSelected","showDropdown","search","currentModels","updateCurrentModelsAndDisplayDropdown","selectedElement","controlSelectedElementWithKeyboard","keyCode","lastIndexOfCurrentModels","disableDropdown","setModel","unbindListener","BettyCropperService","$interpolate","IMAGE_SERVER_URL","BC_API_KEY","BettyImage","uploadImageDeferred","fileInputId","fileInput","inputTemplate","imageData","X-Betty-Api-Key","Content-Type","undefined","X-CSRFToken","transformRequest","identity","transformResponse","parseJSON","image","detailPatch","name","credit","selections","updateSelection","ratio","detail","BettyImageFactory","DEFAULT_IMAGE_WIDTH","Selection","width","height","prototype","scaleToFit","scale","fitRatio","thisRatio","scaled","getStyles","selection","scaledSelection","background-image","background-size","floor","background-position","x0","y0","background-repeat","exp","idStr","toString","segmentedId","substr","base_url","x1","y1","source","SelectionFactory","scaleBy","scaledToFit","value","BettyCropper","openImageCropModal","addStyles","hideMetas","editable","imageChangeCallback","isDefined","callImageChangeCallback","param","isFunction","caption","alt","bettyImage","edit","setStyles","imageStyling","parent","ratioWidth","split","ratioHeight","background-color","newImage","resize","removeImage","editImage","$modalInstance","ratios","selectedCrop","cropMode","finished","thumb_container_styles","scaleData","Jcrop","allowSelect","allowMove","allowResize","keySupport","jcrop_api","image_url","Object","keys","setThumbStyles","crop","selectCrop","setOptions","aspectRatio","setSelect","thumb_styles","padding-top","padding-bottom","padding-left","padding-right","jcrop_selection","tellSelect","newSelection","x","x2","y","y2","saveAndQuit","close","saveAndNext","nextRatioIndex","$modal","backdrop","result","utc","local","setContentType","contentType","goToContentTypesCreationPage","currentUser","getCurrentUser","newCurrentUser","logout","modalInstance","addClass","on","modDateTime","dateTimeSelectorModalOnClose","require","dateTimeSelectorModalTitle","TIMEZONE_NAME","dateValid","isNull","tempDateTime","isValid","copy","TIMEZONE_LABEL","tz","timeNowWithOffset","setDate","setDateToday","now","year","month","date","setDateTomorrow","setTimeNow","setTimeMidnight","hour","minute","clearDateTime","confirm","chooseDateTime","retMoment","sponsors","selectSponsor","clearSponsor","modalHideDeleteButton","confirmCallback","modalText","deleteCallback","deleteModalText","deleteModalHideDelete","hideDeleteButton","hideSponsorButton","hidePublishButton","toolsDropdownText","sponsorSelectionModalOnClose","isDirty","LOGO_URL","currentUserName","SAVING","SAVED","SAVE_BUTTON_STATES","saveButtonState","setStateToSaving","setStateToSaved","clearState","ngModel","ngRequired","populateCurrentItemsList","currentItems","updateCallback","text","columnWidth","truncatedText","trunc","tooltipText","displayText","tooltipTrigger","activeNavbarTab","ValidQueryParamsForListPage","currentService","serviceName","setList","searchQuery","orderBy","order_by","orderByContainsNewOrderValue","endsWith","orderByIsAlreadyInverted","startsWith","pageNumber","page","pick","omit","isNumber","sections","href","title","sortBy","active","moduleName","DEFAULT_ID","err","$compile","$parse","paginationService","terminal","multiElement","priority","compile","tElement","tAttrs","expression","dirPaginate","match","filterPattern","itemsPerPageFilterRemoved","collectionGetter","rawId","paginationId","registerInstance","repeatExpression","idDefinedInFilter","hasAttribute","$set","eq","attr","currentPageGetter","currentPage","defaultCurrentPage","setCurrentPageParser","setAsyncModeTrue","setCollectionLength","$watchCollection","collection","paginationTemplate","generatePagesArray","collectionLength","rowsPerPage","paginationRange","pages","totalPages","ceil","halfWay","ellipsesNeeded","calculatePageNumber","openingEllipsesNeeded","closingEllipsesNeeded","numberRegex","elem","getPath","maxSize","onPageChange","goToPage","num","isValidPageNumber","getCollectionLength","getItemsPerPage","pagination","current","updateRangeValues","generatePagination","getCurrentPage","last","setCurrent","itemsPerPage","range","lower","upper","min","test","isRegistered","idMessage","directionLinks","$parent","$eval","boundaryLinks","max","previous","previousPage","setCurrentPage","end","start","Array","isAsyncMode","setItemsPerPage","slice","lastRegisteredInstance","instances","instanceId","asyncMode","getLastInstanceId","val","currentPageParser","context","assign","parser","provider","templatePath","setPath","$get","sponsorSelectonModalTitle","items","fetchItemsThatMatchSearch","tagsAreBeingFetchedFromTheServer","updateCurrentItemsAndDisplayDropdown","currentItemsIds","item","contains","lastIndexOfCurrentItems","addItem","isCurrentTagInCurrentItemsPredicate","matches","currentObjectFetchedFromCurrentItems","find","removeItem","itemToBeRemovedFromArray","dateFilter","inDate","newdate","formattedDate","currentVideo","player","videojs","controls","autoplay","pause","$on","dispose"],"mappings":"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","sourcesContent":["'use strict';\n\n// ****** App Config ****** \\\\\nangular.module('moment', []).constant('moment', window.moment);\nangular.module('$', []).constant('$', window.$);\n\nangular.module('videoHub', [\n    '$',\n    'ngCookies',\n    'ngRoute',\n    'ngAnimate',\n    'ngMessages',\n    'restangular',\n    'highcharts-ng',\n    'BettyCropper',\n    'ui.bootstrap',\n    'ui.sortable',\n    'LocalStorageModule',\n    'moment'\n  ])\n  .config(function (RestangularProvider) {\n    /**\n     * restangular configurations and interceptors\n     */\n\n    //Set the base URL for the Restangular stuff\n    RestangularProvider.setBaseUrl('/api/v0/');\n\n    // We need a response interceptor for 'getList' becuase it contains additional\n    //  metadata that is normally stripped out by restangular\n    RestangularProvider.addResponseInterceptor(function(data, operation) {\n      if (operation === 'getList') {\n        var results = data.results;\n        if (results) {\n          results.meta = {\n            count: data.count,\n            prev: data.prev,\n            next: data.next\n          };\n        }\n        return results;\n      }\n      return data;\n    });\n\n    // Transform publish iso date strings to moments when a response is received\n    var isoDatesToMoments = function (obj) {\n      if (_.has(obj, 'published') && obj.published) {\n        obj.published = moment(obj.published);\n      }\n    };\n    RestangularProvider.addResponseInterceptor(function(data) {\n      if (_.isArray(data)){\n        _.each(data, isoDatesToMoments);\n      } else {\n        isoDatesToMoments(data);\n      }\n      return data;\n    });\n\n    // Transform publish moments to iso date strings when requests are going out\n    var momentsToIsoDates = function (obj) {\n      if (_.has(obj, 'published') && moment.isMoment(obj.published)) {\n        obj.published = obj.published.format();\n      }\n    };\n    RestangularProvider.addRequestInterceptor(function (element) {\n      momentsToIsoDates(element);\n      return element;\n    });\n\n  })\n  .config(function($locationProvider, $httpProvider, $routeProvider, $sceDelegateProvider, RestangularProvider) {\n    //TODO: Put this code into a more meaningful locaiton. Throwing all of this stuff into config is not proper\n    //Add some stuff to the whitelist to prevent XSS blocking stuff\n    $sceDelegateProvider.resourceUrlWhitelist(['self', 'http://assets.onionstatic.com/videoads/*', 'http://onionwebtech.s3.amazonaws.com/**', 'http://tv.theonion.com/**', 'http://v.theonion.com/**']);\n\n    $locationProvider.html5Mode(true);\n\n    $routeProvider\n      .when('/cms/', {\n        templateUrl: 'components/list-pages/videolist/videolist.html',\n        controller: 'VideoListController',\n        reloadOnSearch: false\n      })\n      .when('/cms/sliders/', {\n        templateUrl: 'components/list-pages/slider-list/slider-list.html',\n        controller: 'SliderListController'\n      })\n      .when('/cms/sliders/:sliderId/', {\n        templateUrl: 'components/detail-pages/slider-detail/slider-detail.html',\n        controller: 'SliderDetailController'\n      })\n      .when('/cms/series/', {\n        templateUrl: 'components/list-pages/serieslist/serieslist.html',\n        controller: 'SeriesListController',\n        reloadOnSearch: false\n      })\n      .when('/cms/channels/', {\n        templateUrl: 'components/list-pages/channellist/channellist.html',\n        controller: 'ChannelListController',\n        reloadOnSearch: false\n      })\n      .when('/cms/sponsors/', {\n        templateUrl: 'components/list-pages/sponsorlist/sponsorlist.html',\n        controller: 'SponsorListController',\n        reloadOnSearch: false\n      })\n      .when('/cms/login/', {\n        templateUrl: 'components/login/login.html',\n        controller: 'LoginController'\n      })\n      .when('/cms/video/new/', {\n        templateUrl: 'components/detail-pages/videodetail/videodetail.html',\n        controller: 'VideoDetailController'\n      })\n      .when('/cms/video/:videoId/', {\n        templateUrl: 'components/detail-pages/videodetail/videodetail.html',\n        controller: 'VideoDetailController'\n      })\n      .when('/cms/channel/new/', {\n        templateUrl: 'components/detail-pages/channeldetail/channeldetail.html',\n        controller: 'ChannelDetailController'\n      })\n      .when('/cms/channel/:channelId/', {\n        templateUrl: 'components/detail-pages/channeldetail/channeldetail.html',\n        controller: 'ChannelDetailController'\n      })\n      .when('/cms/series/new/', {\n        templateUrl: 'components/detail-pages/seriesdetail/seriesdetail.html',\n        controller: 'SeriesDetailController'\n      })\n      .when('/cms/series/:seriesId/', {\n        templateUrl: 'components/detail-pages/seriesdetail/seriesdetail.html',\n        controller: 'SeriesDetailController'\n      })\n      .when('/cms/sponsors/new/', {\n        templateUrl: 'components/detail-pages/sponsordetail/sponsordetail.html',\n        controller: 'SponsorDetailController'\n      })\n      .when('/cms/sponsors/:sponsorId/', {\n        templateUrl: 'components/detail-pages/sponsordetail/sponsordetail.html',\n        controller: 'SponsorDetailController'\n      })\n      .otherwise({\n        redirectTo: '/cms/'\n      });\n  })\n  .constant('ValidQueryParamsForListPage', [\n    'q', 'page', 'f', 'page_size', 'order_by'\n  ])\n.constant('DetailPageControllerConstants', {\n    SAVED_ALERT_MESSAGE: 'Saved',\n    SOMETHING_WENT_WRONG_ALERT_MESSAGE: 'Something went wrong with saving. Please call your friendly sysadmin.',\n    PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE: 'Please fill in all required fields.',\n    DELETE_SUCCESSFUL: 'Delete successful'\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('ChannelDetailController', function($scope, $routeParams, ChannelService, $location, AlertService, DetailPageControllerConstants, Restangular, SaveButtonStateService) {\n    $scope.channel = {};\n    $scope.fields = {};\n    $scope.accent_color = {};\n\n    $scope.getChannel = function() {\n      if (_.has($routeParams, 'channelId')) {\n\n        return ChannelService.one($routeParams.channelId).get().then(\n          function(data) {\n            $scope.channel = data;\n            $scope.fields.partner = $scope.channel.partner;\n            var accentColorStringAsArray = _.words(data.accent_color);\n            if (accentColorStringAsArray.length >= 1) {\n              $scope.accent_color.r = _.parseInt(accentColorStringAsArray[0]) || 0;\n            }\n\n            if (accentColorStringAsArray.length >= 2) {\n              $scope.accent_color.g = _.parseInt(accentColorStringAsArray[1]) || 0;\n            }\n\n            if (accentColorStringAsArray.length >= 3) {\n              $scope.accent_color.b = _.parseInt(accentColorStringAsArray[2]) || 0;\n            }\n\n          },\n          function(data) {\n            console.log(data);\n          }\n        );\n      } else {\n        $scope.channel = {};\n        Restangular.restangularizeElement(null, $scope.channel, 'channels');\n      }\n    };\n\n    $scope.save = function() {\n      if ($scope.channelDetailForm.$valid) {\n        if (_.has($scope.fields.partner, 'id')) {\n          $scope.channel.partner = $scope.fields.partner.id;\n        } else {\n          $scope.channel.partner = null;\n        }\n\n        $scope.channel.accent_color = $scope.getRGBValueFromFields();\n\n        $scope.channel.save().then($scope.successCallback, displaySomethingWentWrongAlert);\n      } else {\n        if (_.has($scope.channelDetailForm.$error, 'number')){\n          AlertService.error('Accent Color values must be numbers.', true);\n        } else {\n          AlertService.error(DetailPageControllerConstants.PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE, true);\n        }\n      }\n    };\n\n\n\n    $scope.getRGBValueFromFields = function() {\n      var compiled = _.template('<%= r %>,<%= g %>,<%= b %>');\n      var params = {\n        'r': $scope.accent_color.r || 0,\n        'g': $scope.accent_color.g || 0,\n        'b': $scope.accent_color.b || 0\n      };\n\n      return compiled(params);\n    };\n\n    $scope.successCallback = function(channel) {\n      $scope.channelDetailForm.$setPristine();\n      SaveButtonStateService.displaySavingAnimation().then(function() {\n        if (!_.has($routeParams, 'channelId')) {\n          $location.path('cms/channel/' + channel.id + '/');\n        }\n      });\n    };\n\n    $scope.$watch('accent_color.r', function(newValue) {\n      $scope.accent_color.r = validateAccentColorFields(newValue);\n    });\n\n    $scope.$watch('accent_color.g', function(newValue) {\n      $scope.accent_color.g = validateAccentColorFields(newValue);\n    });\n\n    $scope.$watch('accent_color.b', function(newValue) {\n      $scope.accent_color.b = validateAccentColorFields(newValue);\n    });\n\n\n    function validateAccentColorFields(input) {\n      if (input > 999) {\n        return 999;\n      } else {\n        return input;\n      }\n    }\n\n    $scope.dateTimeSelectorCallback = function(newDate) {\n      $scope.channel.published = newDate;\n      $scope.save();\n    };\n\n    function displaySomethingWentWrongAlert() {\n      AlertService.error(DetailPageControllerConstants.SOMETHING_WENT_WRONG_ALERT_MESSAGE, true);\n    }\n\n    $scope.delete = function() {\n      AlertService.info('If you would like to delete a channel, please contact your friendly sysadmin.', true);\n    };\n\n    $scope.getChannel();\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('SeriesDetailController', function($scope, $routeParams, SeriesService, $location, AlertService, Restangular, DetailPageControllerConstants, SaveButtonStateService) {\n    $scope.series = {};\n    $scope.data = {};\n\n    $scope.getSeries = function() {\n      if (_.has($routeParams, 'seriesId')) {\n        return SeriesService.one($routeParams.seriesId).get().then(\n          function(data) {\n            $scope.series = data;\n            $scope.dropdownFields.channel = data.channel;\n            $scope.data.sponsor = data.sponsor;\n            if (!_.isUndefined(data.published)) {\n              $scope.data.published = data.published;\n            }\n          },\n          function(data) {\n            console.log(data);\n          }\n        );\n      } else {\n        $scope.series = {};\n        Restangular.restangularizeElement(null, $scope.series, 'series');\n        $scope.sponsor = {};\n      }\n    };\n\n    $scope.save = function() {\n      if ($scope.seriesDetailForm.$valid) {\n        if (_.has($scope.dropdownFields.channel, 'id')) {\n          $scope.series.channel = $scope.dropdownFields.channel.id;\n        } else {\n          $scope.series.channel = null;\n        }\n\n        if (_.has($scope.data.sponsor, 'id')) {\n          $scope.series.sponsor = $scope.data.sponsor.id;\n        } else {\n          $scope.series.sponsor = null;\n        }\n\n        if (_.isEmpty($scope.data.published)) {\n          $scope.series.published = null;\n        } else {\n          $scope.series.published = $scope.data.published;\n        }\n        $scope.series.save().then($scope.successCallback, displaySomethingWentWrongAlert);\n      } else {\n        AlertService.error(DetailPageControllerConstants.PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE, true);\n      }\n    };\n\n    $scope.successCallback = function(series) {\n      $scope.seriesDetailForm.$setPristine();\n      SaveButtonStateService.displaySavingAnimation().then(function() {\n        if (!_.has($routeParams, 'seriesId')) {\n          $location.path('cms/series/' + series.id);\n        }\n      });\n    };\n\n    function displaySomethingWentWrongAlert() {\n      AlertService.error(DetailPageControllerConstants.SOMETHING_WENT_WRONG_ALERT_MESSAGE, true);\n    }\n\n    $scope.dateTimeSelectorCallback = function(newDate) {\n      $scope.data.published = newDate;\n      $scope.save();\n    };\n\n    $scope.delete = function() {\n      AlertService.info('If you would like to delete a series, please contact your friendly sysadmin.', true);\n    };\n    $scope.dropdownFields = {};\n    $scope.getSeries();\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .controller('SliderDetailController', function ($scope, $q, $routeParams, AlertService,\n      SaveButtonStateService, SliderService, DetailPageControllerConstants, Restangular) {\n\n    var normalizeSlideIndicies = function () {\n      // update indicies when sortable is updated\n      _.each($scope.slider.slides, function (slide, i) {\n        slide.position = i;\n      });\n    };\n\n    $scope.slider = {};\n    $scope.$getSlider = function (sliderId) {\n      return SliderService.one(sliderId).get()\n        .then(function(data) {\n          $scope.slider = data;\n          normalizeSlideIndicies();\n        })\n        .catch(function(data) {\n          console.log(data);\n        });\n    };\n\n    // ui-sortable setup\n    $scope.sortableOptions = {\n      containment: 'document',\n      opacity: 0.75,\n      placeholder: 'dropzone',\n      stop: function () {\n        $scope.sliderDetailForm.$setDirty();\n        normalizeSlideIndicies();\n      }\n    };\n\n    /**\n     * Add a new slide.\n     */\n    $scope.addSlide = function () {\n      if (!_.isArray($scope.slider.slides)) {\n        // ensure slider slides list is initialized\n        $scope.slider.slides = [];\n      }\n\n      $scope.slider.slides.push({});\n      $scope.sliderDetailForm.$setDirty();\n      normalizeSlideIndicies();\n    };\n\n    /**\n     * Remove a slide.\n     *\n     * @param {Object} slide - slide to remove from slider.\n     */\n    $scope.removeSlide = function (slide) {\n      if (slide) {\n        var i = _.findIndex($scope.slider.slides, slide);\n        if (i >= 0) {\n          $scope.slider.slides.splice(i, 1);\n          $scope.sliderDetailForm.$setDirty();\n          normalizeSlideIndicies();\n        }\n      }\n    };\n\n    /**\n     * Save changes to slider.\n     *\n     * @returns {Promise} resolves based on {@link AlertService}.\n     */\n    $scope.$saveSlider = function () {\n      var promise;\n\n      if ($scope.sliderDetailForm.$valid) {\n        // form is valid, attempt to save\n        promise = $scope.slider.save()\n          .then(function () {\n            $scope.sliderDetailForm.$setPristine();\n            // success in saving, display success alert\n            return SaveButtonStateService\n                .displaySavingAnimation()\n                .then(function() {\n                  if (!_.has($routeParams, 'sliderId')) {\n                    $location.path('cms/sliders/' + $scope.slider.id + '/');\n                  }\n                });\n          })\n          .catch(function () {\n            return AlertService.error(\n              DetailPageControllerConstants.SOMETHING_WENT_WRONG_ALERT_MESSAGE,\n              true);\n          });\n      } else {\n        // form is not valid, reject saving with an alert\n        promise = AlertService.error(\n            DetailPageControllerConstants.PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE,\n            true);\n      }\n\n      return promise;\n    };\n\n    // set up\n    if (_.has($routeParams, 'sliderId')) {\n      // exising slider, use route id\n      $scope.$getSlider($routeParams.sliderId);\n    } else {\n      // this is a new slider\n      Restangular.restangularizeElement(null, $scope.slider, 'sliders');\n    }\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .directive('sliderDetailSlide', [function () {\n    return {\n      restrict: 'E',\n      scope: {\n        slide: '=slideData',\n        removeFunction: '&',\n        parentForm: '='\n      },\n      templateUrl: 'components/detail-pages/slider-detail/slider-detail-slide/slider-detail-slide.html'\n    };\n  }]);\n","'use strict';\n\nangular.module('videoHub')\n  .controller('SponsorDetailController', function($scope, $routeParams, SponsorService, $location, AlertService, Restangular, DetailPageControllerConstants, SaveButtonStateService) {\n    $scope.sponsor = {};\n    $scope.hideDatetimeSelectionModal = true;\n\n    $scope.getSponsor = function() {\n      if (_.has($routeParams, 'sponsorId')) {\n        return SponsorService.one($routeParams.sponsorId).get().then(\n          function(data) {\n            $scope.sponsor = data;\n          },\n          function(data) {\n            console.log(data);\n          }\n        );\n      } else {\n        $scope.sponsor = {};\n        Restangular.restangularizeElement(null, $scope.sponsor, 'sponsors');\n      }\n    };\n\n    $scope.save = function() {\n      if ($scope.sponsorDetailForm.$valid) {\n        $scope.sponsor.save().then($scope.successCallback, displaySomethingWentWrongAlert);\n      } else {\n        AlertService.error(DetailPageControllerConstants.PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE, true);\n      }\n    };\n\n    $scope.successCallback = function(newSponsor) {\n      $scope.sponsorDetailForm.$setPristine();\n      SaveButtonStateService.displaySavingAnimation().then(function() {\n        if (!_.has($routeParams, 'sponsorId')) {\n          $location.path('cms/sponsors/' + newSponsor.id);\n        }\n      });\n    };\n\n\n    function displaySomethingWentWrongAlert() {\n      AlertService.error(DetailPageControllerConstants.SOMETHING_WENT_WRONG_ALERT_MESSAGE, true);\n    }\n\n    $scope.delete = function() {\n      AlertService.info('If you would like to delete a sponsor, please contact your friendly sysadmin.', true);\n    };\n    $scope.getSponsor();\n  });\n","'use strict';\nangular.module('videoHub').directive('channelSelection', ['DropdownFilterService', function(DropdownFilterService) {\n  return {\n    templateUrl: 'components/detail-pages/videodetail/channelselection/channelselection.html',\n    transclude: true,\n    link: function($scope) {\n      $scope.data = DropdownFilterService.data;\n      $scope.channelFieldChanged = function() {\n        DropdownFilterService.setChannel($scope.data.channel);\n      };\n      $scope.seriesFieldChanged = function() {\n        DropdownFilterService.setSeries($scope.data.series);\n      };\n      DropdownFilterService.populateChannelList();\n    }\n  };\n}]);\n","'use strict';\nangular.module('videoHub')\n  .service('DropdownFilterService', function(ChannelService, SeriesService, SeasonService) {\n\n    //There are places you can have thistakes in this service, so instead of using this, I use DropdownFilterService\n    var DropdownFilterService = this;\n    DropdownFilterService.data = {};\n    DropdownFilterService.filter = {};\n\n    DropdownFilterService.setChannel = function(newChannel) {\n      if (newChannel) {\n        DropdownFilterService.data.channel = newChannel;\n        DropdownFilterService.updateFilter();\n        DropdownFilterService.setSeries(null);\n        DropdownFilterService.populateSeriesList();\n      } else {\n        DropdownFilterService.clear();\n      }\n    };\n\n    DropdownFilterService.setSeries = function(newSeries) {\n      if (newSeries) {\n        DropdownFilterService.data.series = newSeries;\n        DropdownFilterService.updateFilter();\n        DropdownFilterService.populateSeasonList();\n      } else {\n        DropdownFilterService.data.series = null;\n        DropdownFilterService.data.season = null;\n      }\n    };\n\n    DropdownFilterService.setSeason = function(newSeason) {\n      if (newSeason) {\n        DropdownFilterService.data.season = newSeason;\n        DropdownFilterService.season = newSeason;\n      } else {\n        DropdownFilterService.season = null;\n      }\n    };\n\n    DropdownFilterService.setChannelList = function(channelList) {\n      DropdownFilterService.data.channelList = channelList;\n    };\n\n    DropdownFilterService.clear = function() {\n      DropdownFilterService.data.channel = null;\n      DropdownFilterService.data.series = null;\n      DropdownFilterService.data.season = null;\n    };\n\n    DropdownFilterService.updateFilter = function() {\n      if (_.has(DropdownFilterService.data.channel, 'id')) {\n        DropdownFilterService.filter.channelId = DropdownFilterService.data.channel.id;\n      } else {\n        DropdownFilterService.filter.channelId = null;\n      }\n\n      if (_.has(DropdownFilterService.data.series, 'id')) {\n        DropdownFilterService.filter.seriesId = DropdownFilterService.data.series.id;\n      } else {\n        DropdownFilterService.filter.seriesId = null;\n      }\n    };\n\n    DropdownFilterService.populateChannelList = function() {\n      return ChannelService.getList({\n        'page_size': 100\n      }).then(DropdownFilterService.setChannelList);\n    };\n\n    DropdownFilterService.populateSeriesList = function() {\n      return SeriesService.getList({\n        'page_size': 100,\n        'f': 'channel:' + DropdownFilterService.filter.channelId\n      }).then(function(data) {\n        DropdownFilterService.data.seriesList = data;\n      });\n    };\n\n    DropdownFilterService.populateSeasonList = function() {\n      return SeasonService.getList({\n        'page_size': 100,\n        'f': 'series:' + DropdownFilterService.filter.seriesId\n      }).then(function(data) {\n        DropdownFilterService.data.seasonList = data;\n      });\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('VideoDetailController', function($scope, $routeParams, VideoService, $location, SaveButtonStateService, DropdownFilterService, Restangular, DetailPageControllerConstants, AlertService) {\n    $scope.video = {};\n\n    $scope.getVideo = function() {\n      if (_.has($routeParams, 'videoId')) {\n        return VideoService.one($routeParams.videoId).get().then(\n          $scope.setVideo,\n          function(data) {\n            console.log(data);\n          }\n        );\n      } else {\n        $scope.video = {};\n        Restangular.restangularizeElement(null, $scope.video, 'videos');\n        $scope.setVideo($scope.video);\n      }\n    };\n\n    $scope.setVideo = function(data) {\n      if (_.isEmpty(data.input)) {\n        data.input = '';\n      }\n      $scope.video = data;\n      if (_.isUndefined($scope.video.tags)) {\n        $scope.video.tags = [];\n      }\n\n      $scope.data.tagObjects = $scope.video.tags;\n      $scope.video.tags = _.pluck($scope.video.tags, 'id');\n\n      if (!_.isUndefined(data.channel)) {\n        DropdownFilterService.setChannel(data.channel);\n      }\n      if (!_.isUndefined(data.series)) {\n        DropdownFilterService.setSeries(data.series);\n      }\n      if (!_.isUndefined(data.sponsor)) {\n        $scope.data.sponsor = data.sponsor;\n      }\n\n      if (!_.isUndefined(data.published)) {\n        $scope.published = data.published;\n      }\n    };\n\n    $scope.save = function() {\n      if ($scope.videoDetailForm.$valid) {\n\n        //TODO: this _has(blah)... thing happens enough that it should be a function.\n        if (_.has(DropdownFilterService.data.channel, 'id')) {\n          $scope.video.channel = DropdownFilterService.data.channel.id;\n        } else {\n          $scope.video.channel = null;\n        }\n\n        if (_.has(DropdownFilterService.data.series, 'id')) {\n          $scope.video.series = DropdownFilterService.data.series.id;\n        } else {\n          $scope.video.series = null;\n        }\n\n        if (_.has(DropdownFilterService.data.season, 'id')) {\n          $scope.video.season = DropdownFilterService.data.season.id;\n        } else {\n          $scope.video.season = null;\n        }\n\n        $scope.video.tags = _.pluck($scope.data.tagObjects, 'id');\n        $scope.video.save().then($scope.successCallback, displaySomethingWentWrongAlert);\n      } else {\n        AlertService.error(DetailPageControllerConstants.PLEASE_FILL_IN_ALL_REQUIRED_FIELDS_ALERT_MESSAGE, true);\n      }\n    };\n\n    function displaySomethingWentWrongAlert() {\n      AlertService.error(DetailPageControllerConstants.SOMETHING_WENT_WRONG_ALERT_MESSAGE, true);\n    }\n\n    $scope.successCallback = function(video) {\n      $scope.videoDetailForm.$setPristine();\n      SaveButtonStateService.displaySavingAnimation().then(function() {\n        if (!_.has($routeParams, 'videoId')) {\n          $location.path('cms/video/' + video.id + '/');\n        }\n      });\n    };\n\n    $scope.delete = function() {\n      $scope.video.remove().then(function() {\n        AlertService.success(DetailPageControllerConstants.DELETE_SUCCESSFUL, true).then(function() {\n          $location.path('cms/');\n        });\n      });\n    };\n\n    $scope.dateTimeSelectorCallback = function(newDate) {\n      $scope.video.published = newDate;\n      $scope.save();\n    };\n\n    $scope.data = {};\n    $scope.getVideo();\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .constant('VideoFieldConstants', {\n    FILE_TOO_LARGE_ERROR_MESSAGE: 'Upload file cannot be larger than 1024MB.',\n    MUST_UPLOAD_FILES_ERROR_MESSAGE: 'You must upload a video file.',\n    PLEASE_SELECT_A_FILE_ERROR_MESSAGE: 'Please select a file.',\n    UPLOAD_COMPLETE_SUCCESS_MESSAGE: 'Upload Complete'\n  })\n  .directive('videoField', function(Zencoder, $q) {\n    return {\n      templateUrl: 'components/detail-pages/videodetail/videofield/videofield.html',\n      transclude: true,\n      controller: function($scope, $timeout, VideoFieldConstants, VideoService, AlertService) {\n\n        $scope.uploadVideo = function() {\n          var fileField = $('#' + $scope.video.id + '-file-field');\n          fileField.unbind('change');\n          fileField.bind('change', function(event) {\n            var file = event.target.files[0];\n            $scope.validateVideoFile(file)\n              .then($scope.addVideo)\n              .then(Zencoder.uploadToS3AndEncode)\n              .then(\n                function() {\n                  $scope.encodingProgress = 100;\n                  $scope.fetchNewVideoObject();\n                },\n                function(e) {\n                  AlertService.error(e, true);\n                },\n                function(e) {\n                  if (!_.isUndefined(e)) {\n                    if (e.loaded) {\n                      $scope.uploadProgress = Math.round((e.loaded / e.total) * 100);\n                    } else if (e.progress) {\n                      $scope.encodingProgress = Math.round(e.progress) || 0;\n                    }\n                  }\n                });\n          });\n          fileField.click();\n        };\n\n        $scope.validateVideoFile = function(file) {\n          var validateVideoFileDeferred = $q.defer();\n          if (file) {\n            if (file.size > (1024 * 1024 * 1024)) {\n              validateVideoFileDeferred.reject(VideoFieldConstants.FILE_TOO_LARGE_ERROR_MESSAGE);\n            } else if (file.type.indexOf('video/') !== 0) {\n              validateVideoFileDeferred.reject(VideoFieldConstants.MUST_UPLOAD_FILES_ERROR_MESSAGE);\n            } else {\n              validateVideoFileDeferred.resolve(file);\n            }\n          } else {\n            validateVideoFileDeferred.reject(VideoFieldConstants.PLEASE_SELECT_A_FILE_ERROR_MESSAGE);\n          }\n          return validateVideoFileDeferred.promise;\n        };\n\n        $scope.addVideo = function(file) {\n          var addVideoDeferred = $q.defer();\n\n          $scope.video.doGET('encoding_auth').then(function(encodingPayload) {\n            $scope.video.encoding_payload = encodingPayload;\n            var uploadToS3Arguments = {\n              'file': file,\n              'videoObject': $scope.video\n            };\n            addVideoDeferred.resolve(uploadToS3Arguments);\n          });\n          return addVideoDeferred.promise;\n        };\n\n        $scope.checkIfSourcesHaveLoadedAndRetryIfTheyAreNot = function(response) {\n          if (_.isEmpty(response.sources)) {\n            $timeout($scope.fetchNewVideoObject, 2000);\n          } else {\n            $scope.video = response;\n          }\n        };\n\n        $scope.fetchNewVideoObject = function() {\n          // We reload the video after all of the fun is over, in order to update it with the new sources.\n          VideoService.one($scope.video.id).get()\n            .then($scope.checkIfSourcesHaveLoadedAndRetryIfTheyAreNot);\n        };\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .constant('ZencoderConstants', {\n    'UPLOAD_TO_S3_PROGRESS_MESSAGE': 'Uploading X% complete',\n    'UPLOAD_TO_S3_UPLOAD_BEGINNING_MESSAGE': 'Uploading...',\n    'UPLOAD_TO_S3_UPLOAD_COMPLETE_MESSAGE': 'Upload Complete. Begin Encoding.',\n    'UPLOAD_TO_S3_UPLOAD_FAILED_MESSAGE': 'Upload Failed',\n    'ENCODE_FAILED_MESSAGE': 'Encoding has failed.',\n    'ENCODE_PROGRESS_MESSAGE': 'Encoding: X%'\n  })\n  .service('Zencoder', function Zencoder($http, $q, $interval, ZencoderConstants) {\n\n    this.uploadToS3AndEncode = function(config) {\n      var uploadToS3AndEncodeDeferred = $q.defer();\n      var file = config.file;\n      var videoObject = config.videoObject;\n      //TODO: error messaging for invalid config file\n      var successCallback = function(success) {\n        uploadToS3AndEncodeDeferred.resolve(success);\n      };\n      var errorCallback = function(error) {\n        uploadToS3AndEncodeDeferred.reject(error);\n      };\n      var notifyCallback = function(notify) {\n        uploadToS3AndEncodeDeferred.notify(notify);\n      };\n\n      uploadToS3(file, videoObject)\n        .then(encode, errorCallback, notifyCallback)\n        .then(successCallback, errorCallback, notifyCallback);\n\n      return uploadToS3AndEncodeDeferred.promise;\n    };\n\n    function uploadToS3(file, videoObject) {\n      var s3Config = videoObject.encoding_payload;\n      var s3deferred = $q.defer();\n      //TODO: setup form data function\n      var formData = new FormData();\n      formData.append('key', s3Config.key);\n      formData.append('AWSAccessKeyId', s3Config.AWSAccessKeyId);\n      formData.append('acl', s3Config.acl);\n      formData.append('success_action_status', s3Config.success_action_status);\n      formData.append('policy', s3Config.policy);\n      formData.append('signature', s3Config.signature);\n      formData.append('file', file);\n      //We use XMLHttpRequest here becuase angular's http methods don't support progress updates.\n      //TODO: move this into separate function\n      var xhr = new XMLHttpRequest();\n      xhr.open('POST', s3Config.upload_endpoint);\n\n      xhr.upload.onprogress = function(e) {\n        s3deferred.notify(e);\n      };\n\n      xhr.onload = function() {\n        s3deferred.resolve(videoObject);\n      };\n\n      xhr.addEventListener('error', function() {\n        s3deferred.reject(ZencoderConstants.UPLOAD_TO_S3_UPLOAD_FAILED_MESSAGE);\n      });\n\n      xhr.send(formData);\n      return s3deferred.promise;\n\n    }\n\n    function encode(videoObject) {\n      var encodeDeferred = $q.defer();\n      videoObject.doPOST({}, 'encode')\n        .then(function(response) {\n          var zencoderProgressEndpoint = response.json;\n          //TODO: Remove horrible interval stuff, just obnoxous\n          var progressInterval = $interval(function() {\n            $http({\n              url: zencoderProgressEndpoint,\n              method: 'GET',\n              'ignoreAuthorizationHeader': true\n            }).then(function(response) {\n              if (response.data.state === 'finished') {\n                encodeDeferred.resolve(videoObject);\n                $interval.cancel(progressInterval);\n              } else if (response.data.state === 'failed') {\n                encodeDeferred.reject(ZencoderConstants.ENCODE_FAILED_MESSAGE);\n                $interval.cancel(progressInterval);\n              } else {\n                if (!_.isUndefined(response.data.progress)) {\n                  encodeDeferred.notify(response.data);\n                }\n              }\n            });\n          }, 2000);\n        }, function(data) {\n          encodeDeferred.reject(data);\n        });\n      return encodeDeferred.promise;\n    }\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('ChannelListController', function($scope, $location, $routeParams, $rootScope, ListService) {\n    ListService.setService('ChannelService');\n\n    $scope.update = function () {\n      $scope.list = ListService.data.list;\n      $scope.totalItems = ListService.data.totalItems;\n      $scope.params = ListService.getParams();\n    };\n    ListService.updateList().then($scope.update);\n\n    $scope.changeToEditPage = function(id) {\n      $location.path('cms/channel/' + id + '/');\n    };\n\n    $scope.setOrderAndUpdateList = function(newOrderValue) {\n      ListService.setOrder(newOrderValue);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.clearSearchAndUpdateList = function() {\n      ListService.clearSearch();\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.pageChanged = function(newPageNumber) {\n      ListService.setPage(newPageNumber);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.selectSearchBox = function(){\n      $('#searchBox').focus();\n    };\n\n    $scope.setSearchAndUpdateList = function() {\n      ListService.setSearch($scope.params.q);\n      ListService.updateList().then($scope.update);\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('SeriesListController', function($scope, $location, $routeParams, $rootScope, ListService) {\n    ListService.setService('SeriesService');\n\n    $scope.update = function () {\n      $scope.list = ListService.data.list;\n      $scope.totalItems = ListService.data.totalItems;\n      $scope.params = ListService.getParams();\n    };\n    ListService.updateList().then($scope.update);\n\n    $scope.changeToEditPage = function(id) {\n      $location.path('cms/series/' + id + '/');\n    };\n\n    $scope.setOrderAndUpdateList = function(newOrderValue) {\n      ListService.setOrder(newOrderValue);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.clearSearchAndUpdateList = function() {\n      ListService.clearSearch();\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.pageChanged = function(newPageNumber) {\n      ListService.setPage(newPageNumber);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.selectSearchBox = function(){\n      $('#searchBox').focus();\n    };\n\n    $scope.setSearchAndUpdateList = function() {\n      ListService.setSearch($scope.params.q);\n      ListService.updateList().then($scope.update);\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .controller('SliderListController', function ($, $scope, $location, ListService) {\n    ListService.setService('SliderService');\n\n    var update = function () {\n      $scope.sliders = ListService.data.list;\n      $scope.totalItems = ListService.data.totalItems;\n      $scope.params = ListService.getParams();\n    }\n    ListService.updateList().then(update);\n\n    $scope.setFilterAndUpdateList = function(newFilterValue) {\n      ListService.setFilter(newFilterValue);\n      ListService.updateList().then(update);\n    };\n\n    $scope.changeToEditPage = function (id) {\n      $location.path('cms/sliders/' + id + '/');\n    };\n\n    $scope.setOrderAndUpdateList = function (newOrderValue) {\n      ListService.setOrder(newOrderValue);\n      ListService.updateList().then(update);\n    };\n\n    $scope.clearSearchAndUpdateList = function () {\n      ListService.clearSearch();\n      ListService.updateList().then(update);\n    };\n\n    $scope.pageChanged = function (newPageNumber) {\n      ListService.setPage(newPageNumber);\n      ListService.updateList().then(update);\n    };\n\n    $scope.selectSearchBox = function () {\n      $('#searchBox').focus();\n    };\n\n    $scope.setSearchAndUpdateList = function () {\n      ListService.setService($scope.params.q);\n      ListService.updateList().then(update);\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('SponsorListController', function($scope, $location, $routeParams, $rootScope, ListService) {\n    ListService.setService('SponsorService');\n\n    $scope.update = function () {\n      $scope.list = ListService.data.list;\n      $scope.totalItems = ListService.data.totalItems;\n      $scope.params = ListService.getParams();\n    };\n    ListService.updateList().then($scope.update);\n\n    $scope.changeToEditPage = function(id) {\n      $location.path('cms/sponsors/' + id + '/');\n    };\n\n    $scope.setOrderAndUpdateList = function(newOrderValue) {\n      ListService.setOrder(newOrderValue);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.clearSearchAndUpdateList = function() {\n      ListService.clearSearch();\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.selectSearchBox = function(){\n      $('#searchBox').focus();\n    };\n\n    $scope.pageChanged = function(newPageNumber) {\n      ListService.setPage(newPageNumber);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.setSearchAndUpdateList = function() {\n      ListService.setSearch($scope.params.q);\n      ListService.updateList().then($scope.update);\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('VideoListController', function($scope, $location, $routeParams, $rootScope, ListService) {\n    ListService.setService('VideoService');\n\n    $scope.update = function () {\n      $scope.list = ListService.data.list;\n      $scope.totalItems = ListService.data.totalItems;\n      $scope.params = ListService.getParams();\n    };\n    ListService.updateList().then($scope.update);\n\n    $scope.changeToEditPage = function(id) {\n      $location.path('cms/video/' + id + '/');\n    };\n\n    $scope.setOrderAndUpdateList = function(newOrderValue) {\n      ListService.setOrder(newOrderValue);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.clearSearchAndUpdateList = function() {\n      ListService.clearSearch();\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.selectSearchBox = function(){\n      $('#searchBox').focus();\n    };\n\n    $scope.pageChanged = function(newPageNumber) {\n      ListService.setPage(newPageNumber);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.setSearchAndUpdateList = function() {\n      ListService.setSearch($scope.params.q);\n      ListService.updateList().then($scope.update);\n    };\n\n    $scope.new = function() {\n      $location.path('cms/new/');\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n    .controller('LoginController', function($scope, authService, $location, $rootScope) {\n        $rootScope.showSearchBar = false;\n        $rootScope.showSaveButton = false;\n        $scope.username = '';\n        $scope.password = '';\n        $scope.submitLogin = function() {\n            authService.login($scope.username, $scope.password);\n        };\n    });\n","'use strict';\nangular.module('videoHub')\n  .directive('alertbar', function() {\n    return {\n      templateUrl: 'shared/alert/alert-directive.html',\n      restrict: 'E',\n      controller: function($scope, AlertService) {\n        $scope.alertStatus = AlertService.alertStatus;\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .constant('AlertServiceConstants', {\n    TIME_TO_WAIT_BEFORE_CLEARING: 2000\n  })\n  .service('AlertService', function($timeout, $q, AlertServiceConstants) {\n    this.alertStatus = {};\n    this.clear = function(clearAfterDisplayingMessageFlag) {\n      if (_.isUndefined(clearAfterDisplayingMessageFlag)){\n        this.setAlertStatusElementsToFalse();\n      }\n      var alertDeferred = $q.defer();\n      var alertService = this;\n      if (clearAfterDisplayingMessageFlag) {\n        $timeout(function() {\n          alertService.setAlertStatusElementsToFalse();\n          alertDeferred.resolve();\n        }, AlertServiceConstants.TIME_TO_WAIT_BEFORE_CLEARING);\n      } else {\n        alertDeferred.resolve();\n      }\n\n      return alertDeferred.promise;\n    };\n\n    this.setAlertStatusElementsToFalse = function(){\n      this.alertStatus.error = false;\n      this.alertStatus.info = false;\n      this.alertStatus.success = false;\n    };\n\n    this.success = function(message, clearAfterDisplayingMessageFlag) {\n      this.clear();\n      this.alertStatus.success = message;\n      return this.clear(clearAfterDisplayingMessageFlag);\n    };\n    this.error = function(message, clearAfterDisplayingMessageFlag) {\n      this.clear();\n      this.alertStatus.error = message;\n      return this.clear(clearAfterDisplayingMessageFlag);\n    };\n    this.info = function(message, clearAfterDisplayingMessageFlag) {\n      this.clear();\n      this.alertStatus.info = message;\n      return this.clear(clearAfterDisplayingMessageFlag);\n    };\n  });\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('ChannelService',\nfunction(Restangular) {\n  return Restangular.service('channels');\n});\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('SeasonService',\nfunction(Restangular) {\n  return Restangular.service('seasons');\n});\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('SeriesService',\nfunction(Restangular) {\n  return Restangular.service('series');\n});\n","'use strict';\n\nangular.module('videoHub')\n  .factory('SliderService', function(Restangular) {\n    return Restangular.service('sliders');\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .factory('SlidesService', function(Restangular) {\n    return Restangular.service('slides');\n  });\n","\n'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('SponsorService',\nfunction(Restangular) {\n  return Restangular.service('sponsors');\n});\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('TagsService',\nfunction(Restangular) {\n  return Restangular.service('tags');\n});\n","'use strict';\n//Service to get / create / delete video ads.\nangular.module('videoHub')\n.factory('VideoService',\nfunction(Restangular) {\n  return Restangular.service('videos');\n});\n","'use strict';\nangular.module('videoHub')\n  .factory('authInterceptor', ['$rootScope', '$q', '$location', '$injector', 'httpRequestBuffer', 'localStorageService', function($rootScope, $q, $location, $injector, httpRequestBuffer, localStorageService) {\n    return {\n      'request': function(config) {\n        config.headers = config.headers || {};\n        var token = localStorageService.get('authToken');\n        var isBettyCropperRequest = _.has(config.headers, 'X-Betty-Api-Key');\n        if (token) {\n          if (!config.ignoreAuthorizationHeader && !isBettyCropperRequest) {\n            config.headers.Authorization = 'JWT ' + token;\n          }\n        }\n        return config;\n      },\n      'responseError': function(response) {\n        if (response.config) {\n          var ignoreAuthModule = response.config.ignoreAuthModule || response.config.headers.ignoreAuthModule;\n          if (!ignoreAuthModule) {\n            if (response.status === 403) {\n              var deferred = $q.defer();\n              httpRequestBuffer.append(response.config, deferred);\n              var authService = $injector.get('authService');\n              authService.refreshToken();\n            }\n          }\n        }\n        return $q.reject(response);\n      }\n    };\n  }])\n  .config(['$httpProvider', function($httpProvider) {\n    $httpProvider.interceptors.push('authInterceptor');\n  }])\n  .service('authService', ['$http', '$rootScope', '$location', 'httpRequestBuffer', 'localStorageService', 'AlertService', 'CurrentUser',function($http, $rootScope, $location, httpRequestBuffer, localStorageService, AlertService, CurrentUser) {\n    var _login = function(username, password) {\n      return $http.post('/api/token/auth', {\n          'username': username,\n          'password': password\n        })\n        .success(function(response) {\n          localStorageService.set('authToken', response.token);\n          CurrentUser.setCurrentUser(username);\n          $location.path('cms/');\n        })\n        .error(function() {\n          AlertService.error('Username or password provided is incorrect.', true);\n        });\n    };\n    var _refreshToken = function() {\n      //TODO: put into constant\n      var token = localStorageService.get('authToken');\n      return $http.post('/api/token/refresh', {\n          'token': token\n        }, {\n          'ignoreAuthModule': true\n        }).success(function(response) {\n          localStorageService.set('authToken', response.token);\n          httpRequestBuffer.retryAll();\n        })\n        .error(function() {\n          httpRequestBuffer.rejectAll();\n          AlertService.error('You failed to authenticate. Redirecting to login.', true);\n          //TODO: put into constant\n          $location.path('cms/login');\n        });\n    };\n\n    return {\n      login: _login,\n      refreshToken: _refreshToken\n    };\n  }])\n  // Thanks to witoldsz/angular-http-auth\n  .factory('httpRequestBuffer', ['$injector',\n    function($injector) {\n      var buffer = [];\n\n      var $http;\n\n      function _retryHttpRequest(config, deferred) {\n        function successCallback(response) {\n          deferred.resolve(response);\n        }\n\n        function errorCallback(response) {\n          deferred.reject(response);\n        }\n        $http = $http || $injector.get('$http');\n        config.headers.ignoreAuthModule = true;\n        $http(config).then(successCallback, errorCallback);\n      }\n\n      return {\n        append: function(config, deferred) {\n          buffer.push({\n            config: config,\n            deferred: deferred\n          });\n        },\n        rejectAll: function(reason) {\n          if (reason) {\n            _.each(buffer, function(request) {\n              request.deferred.reject(reason);\n            });\n          }\n          buffer = [];\n        },\n        retryAll: function() {\n          _.each(buffer, function(request) {\n            _retryHttpRequest(request.config, request.deferred);\n          });\n          buffer = [];\n        }\n      };\n    }\n  ]);\n","'use strict';\n\nangular.module('videoHub')\n  .directive('autocomplete', function($injector) {\n    return {\n      templateUrl: 'shared/autocomplete/autocomplete.html',\n      replace: true,\n      scope: {\n        'model': '=',\n        'service': '@service',\n        'labelAttr': '@',\n        'placeholderText': '@',\n      },\n      link: function(scope, element, attrs) {\n        scope.isRequired = attrs.isRequired === 'true';\n      },\n      controller: function($scope) {\n        //Inject service based on provided value\n        var service = $injector.get($scope.service);\n\n        $scope.doSearchAndUpdateCurrentModels = function() {\n          if ($scope.modelSelected || $scope.showDropdown || _.isEmpty($scope.search) || $scope.search.length < 4) {\n            $scope.currentModels = [];\n            $scope.showDropdown = !_.isEmpty($scope.currentModels) && !$scope.modelSelected;\n            return;\n          } else {\n            service.getList({\n              'q': $scope.search\n            }).then($scope.updateCurrentModelsAndDisplayDropdown);\n          }\n        };\n\n        $scope.updateCurrentModelsAndDisplayDropdown = function(data) {\n          if (!_.isUndefined(data)) {\n            $scope.currentModels = data;\n            $scope.showDropdown = !_.isEmpty($scope.currentModels) && !$scope.modelSelected;\n          } else {\n            $scope.currentModels = null;\n            $scope.showDropdown = false;\n          }\n        };\n\n        $scope.selectedElement = 0;\n        $scope.controlSelectedElementWithKeyboard = function(event) {\n          var keyCode = event.keyCode;\n          if ($scope.currentModels) {\n            var lastIndexOfCurrentModels = $scope.currentModels.length - 1;\n            switch (keyCode) {\n              case 27: // ESC\n                $scope.disableDropdown();\n                break;\n              case 40: // DOWN\n                $scope.selectedElement = $scope.selectedElement === lastIndexOfCurrentModels ?\n                  0 :\n                  $scope.selectedElement + 1;\n                break;\n              case 38: // UP\n                $scope.selectedElement = $scope.selectedElement === 0 ?\n                  lastIndexOfCurrentModels :\n                  $scope.selectedElement - 1;\n                break;\n              case 13: // RETURN\n                $scope.setModel($scope.currentModels[$scope.selectedElement]);\n                $scope.selectedElement = 0;\n                break;\n              default:\n                return;\n            }\n          }\n\n        };\n\n        $scope.disableDropdown = function() {\n          $scope.showDropdown = false;\n          $scope.selectedElement = 0;\n          $scope.search = '';\n          $scope.modelSelected = false;\n        };\n\n        $scope.setModel = function(model) {\n          if (!_.isUndefined(unbindListener)) {\n            unbindListener();\n          }\n          $scope.model = model;\n          $scope.search = model[$scope.labelAttr];\n          if ($scope.currentModels) {\n            $scope.currentModels = null;\n          }\n          $scope.modelSelected = true;\n          $scope.showDropdown = false;\n          $scope.selectedElement = 0;\n        };\n\n        $scope.clear = function() {\n          $scope.model = null;\n          $scope.modelSelected = false;\n          $scope.search = '';\n        };\n\n        var unbindListener = $scope.$watch('model', function(newValue) {\n          if (_.has(newValue, 'name')) {\n            $scope.setModel(newValue);\n            unbindListener();\n          }\n        });\n      }\n    };\n  });\n","'use strict';\n(function () {\n  angular.module('BettyCropper', ['restangular'])\n    .value('DEFAULT_IMAGE_WIDTH', 1200)\n    .factory('Selection', SelectionFactory)\n    .factory('BettyImage', BettyImageFactory)\n    .service('BettyCropper', BettyCropperService);\n\n  function BettyCropperService($http, $interpolate, $q, IMAGE_SERVER_URL, BC_API_KEY, BettyImage) {\n      var fileInputId = '#bulbs-cms-hidden-image-file-input';\n      var inputTemplate = '<input id=\"bulbs-cms-hidden-image-file-input\" type=\"file\" accept=\"image/*\" style=\"position: absolute; left:-99999px;\" name=\"image\" />';\n\n      this.upload = upload;\n      this.get = get;\n      this.detail = get;\n      this.detailPatch = detailPatch;\n      this.updateSelection = updateSelection;\n\n      function upload() {\n        var uploadImageDeferred = $q.defer();\n\n        angular.element(fileInputId).remove();\n        var fileInput = angular.element(inputTemplate);\n        angular.element('body').append(fileInput);\n\n        fileInput.click();\n\n        fileInput.unbind('change');\n        fileInput.bind('change', function (e) {\n          if (e.target.files.length !== 1) {\n            uploadImageDeferred.reject('We need exactly one image!');\n          }\n          var file = e.target.files[0];\n          if (file.type.indexOf('image/') !== 0) {\n            uploadImageDeferred.reject('Not an image!');\n          }\n\n          if (file.size > 10 * 1024 * 1024) { // MAGIC!\n            uploadImageDeferred.reject('The file is too large!');\n          }\n\n          var imageData = new FormData();\n          imageData.append('image', file);\n\n          $http({\n            method: 'POST',\n            url: IMAGE_SERVER_URL + '/api/new',\n            headers: {\n              'X-Betty-Api-Key': BC_API_KEY,\n              'Content-Type': undefined,\n              'X-CSRFToken': undefined\n            },\n            data: imageData,\n            transformRequest: angular.identity,\n            transformResponse: function (data, headersGetter) {\n              // So, sometimes the browser doesn't think that JSON data is JSON.\n              if (typeof data === 'string') {\n                data = $.parseJSON(data);\n              }\n              var image = new BettyImage(data);\n              return image;\n            }\n          }).success(function (success) {\n            uploadImageDeferred.resolve(success);\n          }).error(function (error) {\n            uploadImageDeferred.reject(error);\n          });\n\n        });\n\n        return uploadImageDeferred.promise;\n      }\n\n      function get(id) {\n        return $http({\n          method: 'GET',\n          url: IMAGE_SERVER_URL + '/api/' + id,\n          headers: {\n            'X-Betty-Api-Key': BC_API_KEY,\n            'Content-Type': undefined,\n            'X-CSRFToken': undefined\n          },\n          transformRequest: angular.identity,\n          transformResponse: function (data, headersGetter) {\n            if (typeof data === 'string') {\n              data = $.parseJSON(data);\n            }\n            return new BettyImage(data);\n          }\n        });\n      }\n\n      function detailPatch(id, name, credit, selections) {\n        return $http({\n          method: 'PATCH',\n          url: IMAGE_SERVER_URL + '/api/' + id,\n          headers: {\n            'X-Betty-Api-Key': BC_API_KEY,\n            'Content-Type': undefined,\n            'X-CSRFToken': undefined\n          },\n          data: {\n            name: name,\n            credit: credit,\n            selections: selections\n          },\n          transformRequest: angular.identity,\n          transformResponse: function (data, headersGetter) {\n            if (typeof data === 'string') {\n              data = $.parseJSON(data);\n            }\n            return new BettyImage(data);\n          }\n        });\n      }\n\n      function updateSelection(id, ratio, selections) {\n        return $http({\n          method: 'POST',\n          url: IMAGE_SERVER_URL + '/api/' + id + '/' + ratio,\n          headers: {\n            'X-Betty-Api-Key': BC_API_KEY,\n            'Content-Type': undefined,\n            'X-CSRFToken': undefined\n          },\n          data: selections\n        });\n      }\n  }\n\n  function BettyImageFactory($interpolate, $http, IMAGE_SERVER_URL, BC_API_KEY, DEFAULT_IMAGE_WIDTH, Selection) {\n    function BettyImage(data) {\n      this.id = data.id;\n      this.name = data.name;\n      this.width = data.width;\n      this.height = data.height;\n      this.selections = {};\n      for (var ratio in data.selections) {\n        this.selections[ratio] = new Selection(data.selections[ratio]);\n      }\n    }\n\n    BettyImage.prototype.scaleToFit = function(width, height) {\n      var scale;\n      if (width && height) {\n        var fitRatio = width / height;\n        var thisRatio = this.width / this.height;\n        if (fitRatio > thisRatio) {\n          scale = height/ this.height;\n        } else {\n          scale = width / this.width;\n        }\n      } else {\n        if (width) {\n          scale = width / this.width;\n        }\n        if (height) {\n          scale = height/ this.height;\n        }\n      }\n      var scaled = {\n        width: Math.round(this.width * scale),\n        height: Math.round(this.height * scale),\n        scale: scale\n      };\n      return scaled;\n    };\n\n    BettyImage.prototype.getStyles = function(width, height, ratio) {\n      if (height === 0) {\n        height = null;\n      }\n\n      var selection = this.selections[ratio];\n      var scaledSelection = selection.scaleToFit(width, height);\n\n      return {\n        'background-image': 'url(' + this.url('original', DEFAULT_IMAGE_WIDTH, 'jpg') + ')',\n        'background-size': Math.floor(scaledSelection.width() / selection.width()  * this.width) + 'px',\n        'background-position': '-' + scaledSelection.x0 + 'px -' + scaledSelection.y0 + 'px',\n        'height': scaledSelection.height() + 'px',\n        'width': scaledSelection.width() + 'px',\n        'background-repeat': 'no-repeat',\n        'position': 'relative'\n      };\n    };\n\n    BettyImage.prototype.url = function (ratio, width, format) {\n      var exp = $interpolate(\n        '{{ base_url }}/{{ id }}/{{ ratio }}/{{ width }}.{{ format }}'\n      );\n      var idStr = this.id.toString();\n      var segmentedId = '';\n      for (var i=0; i < idStr.length; i++) {\n        if (i % 4 === 0 && i !== 0) {\n          segmentedId += '/';\n        }\n        segmentedId += idStr.substr(i, 1);\n      }\n      return exp({\n        base_url: IMAGE_SERVER_URL,\n        id: segmentedId,\n        ratio: ratio,\n        width: width,\n        format: format\n      });\n    };\n\n    BettyImage.prototype.updateSelection = function (ratio, selection) {\n      var data = {\n        x0: selection.x0,\n        x1: selection.x1,\n        y0: selection.y0,\n        y1: selection.y1\n      };\n      if (selection.source) {\n        data.source = selection.source;\n      }\n      return $http({\n        method: 'POST',\n        url: IMAGE_SERVER_URL + '/api/' + this.id + '/' + ratio,\n        headers: {\n          'X-Betty-Api-Key': BC_API_KEY,\n          'Content-Type': undefined,\n          'X-CSRFToken': undefined\n        },\n        data: data,\n        transformResponse: function (data, headersGetter) {\n          if (typeof data === 'string') {\n            data = $.parseJSON(data);\n          }\n          return [ratio, new Selection(data.selections[ratio])];\n        }\n      });\n    };\n\n    return BettyImage;\n  }\n\n  function SelectionFactory() {\n    function Selection(data) {\n        this.x0 = data.x0;\n        this.x1 = data.x1;\n        this.y0 = data.y0;\n        this.y1 = data.y1;\n        this.source = data.source;\n    }\n\n    Selection.prototype.width = function () {\n      return this.x1 - this.x0;\n    };\n\n    Selection.prototype.height = function () {\n      return this.y1 - this.y0;\n    };\n\n    Selection.prototype.scaleBy = function(scale) {\n      var scaledToFit = new Selection({\n        x0: Math.round(this.x0 * scale),\n        x1: Math.round(this.x1 * scale),\n        y0: Math.round(this.y0 * scale),\n        y1: Math.round(this.y1 * scale)\n      });\n      return scaledToFit;\n    };\n\n    Selection.prototype.scaleToFit = function (width, height) {\n\n      var scale;\n      if (width && height) {\n        var fitRatio = width / height;\n        var thisRatio = this.width() / this.height();\n        if (fitRatio > thisRatio) {\n          scale = height/ this.height();\n        } else {\n          scale = width / this.width();\n        }\n      } else {\n        if (width) {\n          scale = width / this.width();\n        }\n        if (height) {\n          scale = height/ this.height();\n        }\n      }\n      return this.scaleBy(scale);\n    };\n\n    return Selection;\n  }\n})();\n","'use strict';\n\nangular.module('videoHub')\n  .directive('bettyeditable', function($http, BettyCropper, openImageCropModal) {\n    return {\n      restrict: 'E',\n      templateUrl: 'shared/bettycropper/bettyeditable.html',\n      scope: {\n        'image': '=',\n        'addStyles': '@',\n        'placeholderText': '@',\n        'hideMetas': '=',\n        'ratio': '@',\n        'editable': '=?',\n        'imageChangeCallback': '='\n      },\n      controller: function($scope) {\n        $scope.editable = angular.isDefined($scope.editable) ? $scope.editable : true;\n\n        $scope.callImageChangeCallback = function(param){\n          if (_.isFunction($scope.imageChangeCallback)){\n            $scope.imageChangeCallback(param);\n          }\n        };\n        $scope.upload = function() {\n          BettyCropper.upload().then(\n            function(success) {\n              $scope.image = {\n                id: success.id,\n                caption: null,\n                alt: null\n              };\n              $scope.bettyImage = success;\n              $scope.callImageChangeCallback(success);\n            },\n            function(error) {\n              console.log(error);\n            },\n            function(progress) {\n              console.log(progress);\n            }\n          );\n        };\n\n        $scope.edit = function() {\n          openImageCropModal($scope.image).then(function(image) {\n            if (image.id === null) {\n              $scope.image = null;\n            } else {\n              $scope.image = image;\n              BettyCropper.get($scope.image.id).then(function(response) {\n                $scope.bettyImage = response.data;\n                $scope.setStyles();\n              });\n            }\n\n            $scope.callImageChangeCallback();\n          });\n        };\n      },\n\n      link: function(scope, element) {\n\n        if (scope.bettyImage === undefined) {\n          scope.bettyImage = null;\n        }\n\n        scope.setStyles = function() {\n          if (scope.bettyImage) {\n            scope.imageStyling = scope.bettyImage.getStyles(element.parent().width(), element.parent().height(), scope.ratio);\n          } else {\n            var ratioWidth = parseInt(scope.ratio.split('x')[0], 10);\n            var ratioHeight = parseInt(scope.ratio.split('x')[1], 10);\n            scope.imageStyling = {\n              'background-color': '#333',\n              'position': 'relative',\n              'width': element.parent().width(),\n              'height': Math.floor(element.parent().width() * ratioHeight / ratioWidth) + 'px',\n            };\n          }\n        };\n\n        scope.$watch('image', function(newImage) {\n          if (newImage && newImage.id) {\n            BettyCropper.get(newImage.id).then(function(response) {\n              scope.bettyImage = response.data;\n            });\n          }\n        });\n\n        scope.$watch('bettyImage', function() {\n          scope.setStyles();\n        }, true);\n\n        element.resize(scope.setStyles);\n\n        scope.removeImage = function() {\n          scope.image.id = null;\n          scope.callImageChangeCallback();\n        };\n\n        scope.editImage = function() {\n          openImageCropModal(scope.image)\n            .then(function(success) {\n              console.log(success);\n            });\n        };\n\n      }\n    };\n  });\n","'use strict';\n\nangular.module('BettyCropper')\n  .controller('ImageCropModalCtrl', function ($scope, $timeout, $modalInstance, BettyCropper, Selection, DEFAULT_IMAGE_WIDTH, imageData, ratios) {\n    $scope.selectedCrop = null;\n    $scope.cropMode = false;\n    $scope.ratios = ratios;\n    $scope.finished = false;\n    $scope.thumb_container_styles = {};\n    $scope.imageData = imageData;\n\n    if (!$scope.image) {\n      $scope.image = null;\n      BettyCropper.get(imageData.id).then(function(success){\n        $scope.image = success.data;\n      });\n    }\n\n    $scope.$watch('image', function (image) {\n      if (!image) {\n        return;\n      }\n\n      var finished = true;\n      for (var ratio in image.selections) {\n        if (image.selections[ratio].source === 'auto') {\n          finished = false;\n          break;\n        }\n      }\n      $scope.finished = finished;\n\n      $scope.scaleData = image.scaleToFit(550, 400);\n\n      $('.crop-image-container img').one('load', function () {\n        $(this).Jcrop({\n          allowSelect: false,\n          allowMove: true,\n          allowResize: true,\n          keySupport: false\n        }, function () {\n          $scope.jcrop_api = this;\n        });\n      });\n\n      $scope.image_url = image.url('original', DEFAULT_IMAGE_WIDTH, 'jpg');\n      if (!$scope.ratios) {\n        $scope.ratios = Object.keys(image.selections);\n      }\n\n      $scope.setThumbStyles();\n    });\n\n    $scope.$watch('selectedCrop', function(crop) {\n      if (!$scope.image) {\n        return;\n      }\n      var finished = true;\n      for (var ratio in $scope.image.selections) {\n        if ($scope.image.selections[ratio].source === 'auto' && ratio !== crop) {\n          finished = false;\n          break;\n        }\n      }\n      $scope.finished = finished;\n    });\n\n    $scope.selectCrop = function (ratio) {\n      if (!ratio) {\n        ratio = Object.keys($scope.image.selections)[0];\n        for (var key in $scope.image.selections) {\n          if ($scope.image.selections[key].source === 'auto') {\n            ratio = key;\n            break;\n          }\n        }\n      }\n      var selection = $scope.image.selections[ratio].scaleBy($scope.scaleData.scale);\n\n      $scope.jcrop_api.setOptions({\n        aspectRatio: selection.width() / selection.height()\n      });\n\n      $scope.jcrop_api.setSelect([\n        selection.x0,\n        selection.y0,\n        selection.x1,\n        selection.y1\n      ]);\n\n      $scope.cropMode = true;\n      $scope.selectedCrop = ratio;\n    };\n\n    $scope.setThumbStyles = function () {\n      $scope.thumb_styles = $scope.thumb_styles || {};\n\n      for (var ratio in $scope.image.selections) {\n        var scaledSelection = $scope.image.selections[ratio].scaleToFit(170, 170);\n        $scope.thumb_container_styles[ratio] = {\n          'padding-top': Math.round((180 - scaledSelection.height()) / 2) + 'px',\n          'padding-bottom': '5px',\n          'padding-left':  Math.round((180 - scaledSelection.width()) / 2) + 'px',\n          'padding-right': '5px'\n        };\n\n        $scope.thumb_styles[ratio] = $scope.image.getStyles(170, 170, ratio);\n      }\n    };\n\n    $scope.save = function (ratio) {\n\n      var jcrop_selection = $scope.jcrop_api.tellSelect();\n\n      var newSelection = new Selection({\n        x0: jcrop_selection.x,\n        x1: jcrop_selection.x2,\n        y0: jcrop_selection.y,\n        y1: jcrop_selection.y2,\n        source: 'user'\n      });\n      newSelection = newSelection.scaleBy(1 / $scope.scaleData.scale);\n      if (newSelection.x1 > $scope.image.width) {\n        newSelection.x1 = $scope.image.width;\n      }\n      if (newSelection.y1 > $scope.image.height) {\n        newSelection.y1 = $scope.image.height;\n      }\n\n      return this.image.updateSelection(ratio, newSelection);\n    };\n\n    $scope.saveAndQuit = function () {\n      var ratio = $scope.selectedCrop;\n      this.save(ratio).then(function (success) {\n        var ratio = success.data[0];\n        var selection = success.data[1];\n        $scope.image.selections[ratio] = selection;\n      });\n      $scope.cropMode = false;\n      $modalInstance.close(imageData);\n    };\n\n    $scope.saveAndNext = function () {\n      var ratio = $scope.selectedCrop;\n      this.save(ratio).then(function (success) {\n        var ratio = success.data[0];\n        var selection = success.data[1];\n        $scope.image.selections[ratio] = selection;\n\n        var nextRatioIndex = ($scope.ratios.indexOf(ratio) + 1) % $scope.ratios.length;\n\n        $scope.selectCrop($scope.ratios[nextRatioIndex]);\n      });\n    };\n\n  });\n","'use strict';\n\nangular.module('BettyCropper')\n  .factory('openImageCropModal', function ($modal) {\n    var openImageCropModal = function (imageData, ratios) {\n\n      return $modal.open({\n        templateUrl: 'shared/bettycropper/image-crop-modal.html',\n        controller: 'ImageCropModalCtrl',\n        resolve: {\n          imageData: function () { return imageData; },\n          ratios: function () { return ratios || false; }\n        },\n        backdrop: 'static'\n      }).result;\n\n    };\n\n    return openImageCropModal;\n  });\n","'use strict';\n\nangular.module('videoHub')\n.filter('convertToLocal', function() {\n  return function (input) {\n    if (input) {\n      return moment.utc(input).local().format('L \\@ hh:mm');\n    }\n    return input;\n  };\n});\n","'use strict';\n\nangular.module('videoHub')\n  .directive('createContent', function () {\n    return {\n      restrict: 'E',\n      templateUrl:  'shared/create-content/create-content.html',\n      controller: function($scope, $location){\n        $scope.setContentType = function(contentType){\n          $scope.contentType = contentType;\n        };\n\n        $scope.goToContentTypesCreationPage = function(){\n          $location.path('cms/' + $scope.contentType + '/new/');\n        };\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .service('CurrentUser', function(localStorageService, $location) {\n    this.currentUser = null;\n    this.getCurrentUser = function() {\n      return localStorageService.get('currentUser');\n    };\n\n    this.setCurrentUser = function(newCurrentUser) {\n      localStorageService.set('currentUser', newCurrentUser);\n    };\n\n    this.logout = function() {\n      this.currentUser = null;\n      localStorageService.remove('authToken');\n      localStorageService.remove('currentUser');\n      $location.path('cms/login/');\n    };\n  });\n","'use strict';\n\n/**\n * Apply as an attribute to an element, when element is clicked it will open a\n *  a date time selection modal. All functionality is dependent on dates being\n *  moment objects.\n */\nangular.module('videoHub')\n  .directive('dateTimeSelector', function($modal) {\n    return {\n      link: function(scope, element) {\n        var modalInstance = null;\n\n        element.addClass('datetime-selection-modal-opener');\n\n        element.on('click', function() {\n          modalInstance = $modal\n            .open({\n              templateUrl: 'shared/date-time-selector/date-time-selector-modal.html',\n              controller: 'DateTimeSelectorModalController',\n              scope: scope\n            });\n          modalInstance.result\n            .then(function(newDate) {\n              scope.modDateTime = newDate;\n              if (scope.dateTimeSelectorModalOnClose) {\n                scope.dateTimeSelectorModalOnClose(newDate);\n              }\n            });\n        });\n      },\n      restrict: 'A',\n      require: '^ngModel',\n      scope: {\n        modDateTime: '=ngModel',\n        dateTimeSelectorModalTitle: '@',\n        dateTimeSelectorModalOnClose: '='\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n.filter('dateTimeSelectorFormatter', function() {\n  return function (input) {\n    if (input) {\n      return moment(input).format('L \\@ hh:mm');\n    }\n    return input;\n  };\n});\n","'use strict';\n\nangular.module('videoHub')\n  .controller('DateTimeSelectorModalController', function (moment, $scope,\n      $modalInstance, TIMEZONE_NAME) {\n    // ensure that we can't choose a time if date is invalid\n    $scope.dateValid = false;\n\n    $scope.$watch('tempDateTime', function () {\n      $scope.dateValid = !_.isNull($scope.tempDateTime) && moment($scope.tempDateTime).isValid();\n    });\n\n    // copy date temporarily so user has to actually verify change to the date\n    $scope.tempDateTime = angular.copy($scope.modDateTime);\n\n    $scope.TIMEZONE_LABEL = moment.tz(TIMEZONE_NAME).format('z');\n\n    var timeNowWithOffset = function () {\n      return moment.tz(TIMEZONE_NAME);\n    };\n\n    // callback function for using datetime calendar because it doesn't work at all in a sensible way\n    $scope.setDate = function (newDate) {\n      $scope.tempDateTime = moment(newDate);\n    };\n\n    $scope.setDateToday = function () {\n      var now = timeNowWithOffset();\n      $scope.tempDateTime = moment()\n        .year(now.year())\n        .month(now.month())\n        .date(now.date());\n    };\n\n    $scope.setDateTomorrow = function () {\n      var now = timeNowWithOffset();\n      $scope.tempDateTime = moment()\n        .year(now.year())\n        .month(now.month())\n        .date(now.date() + 1);\n    };\n\n    $scope.setTimeNow = function () {\n      $scope.tempDateTime = timeNowWithOffset();\n    };\n\n    $scope.setTimeMidnight = function () {\n      $scope.tempDateTime = timeNowWithOffset().hour(24).minute(0);\n    };\n\n    $scope.clearDateTime = function(){\n      var confirm = window.confirm('Are you sure you wish to unpublish this?');\n      if (confirm){\n        $modalInstance.close(null);\n      }\n    };\n\n    $scope.chooseDateTime = function () {\n      if ($scope.dateValid) {\n        // close modal, ensuring that output date is a moment\n        var retMoment = moment($scope.tempDateTime);\n        $modalInstance.close(retMoment);\n      } else {\n        console.error('Attempting to choose invalid date.');\n      }\n    };\n\n  });\n","'use strict';\nangular.module('videoHub')\n  .controller('DeleteModalController',\n    function($scope, SponsorService, $modalInstance) {\n      SponsorService.getList().then(function(data) {\n        $scope.sponsors = data;\n      });\n\n      $scope.selectSponsor = function(sponsor) {\n        $scope.sponsor = sponsor;\n      };\n\n      $scope.clearSponsor = function() {\n        $scope.sponsor = null;\n      };\n\n      $scope.close = function() {\n        $modalInstance.close(true);\n      };\n    });\n","'use strict';\n/**\n * Apply as an attribute to an element, when element is clicked it will open a\n *  a date time selection modal. All functionality is dependent on dates being\n *  moment objects.\n */\nangular.module('videoHub')\n  .directive('deleteModal', function($modal) {\n    return {\n      controller: function ($scope) {\n        $scope.modalHideDeleteButton =\n          angular.isDefined($scope.modalHideDeleteButton) ?\n            $scope.modalHideDeleteButton :\n              false;\n      },\n      link: function(scope, element) {\n        var modalInstance = null;\n\n        element.addClass('delete-modal-opener');\n\n        element.on('click', function() {\n          modalInstance = $modal\n            .open({\n              templateUrl: 'shared/delete-modal/delete-modal.html',\n              controller: 'DeleteModalController',\n              scope: scope\n            });\n          modalInstance.result\n            .then(function(confirm) {\n              if (confirm) {\n                scope.confirmCallback();\n              }\n            });\n        });\n      },\n      restrict: 'A',\n      scope: {\n        confirmCallback: '=',\n        modalHideDeleteButton: '=?',\n        modalText: '@'\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .directive('detailsNavBar', function() {\n    return {\n      'restrict': 'E',\n      'templateUrl': 'shared/detailsnavbar/detailsnavbar.html',\n      'transclude': true,\n      scope: {\n        'deleteCallback': '=',\n        'deleteModalText': '@',\n        'deleteModalHideDelete': '=?',\n        'sponsor': '=',\n        'hideDeleteButton': '=',\n        'hideSponsorButton': '=',\n        'hidePublishButton': '=',\n        'save': '=saveFunction',\n        'published': '=',\n        'toolsDropdownText': '=',\n        'sponsorSelectionModalOnClose': '&',\n        'dateTimeSelectorModalOnClose': '=',\n        'isDirty': '='\n      },\n      'controller': function($scope, $rootScope, $location, CurrentUser, TIMEZONE_NAME, SaveButtonStateService, LOGO_URL) {\n        $scope.LOGO_URL = LOGO_URL;\n        $scope.currentUserName = CurrentUser.getCurrentUser();\n        $scope.TIMEZONE_LABEL = moment.tz(TIMEZONE_NAME).format('z');\n        $scope.data = {};\n        $scope.data = SaveButtonStateService.data;\n      }\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .constant('SAVE_BUTTON_STATES', {\n    'SAVING': 'saving',\n    'SAVED': 'saved'\n  })\n  .service('SaveButtonStateService', function($timeout, $q, SAVE_BUTTON_STATES) {\n    this.data = {};\n    this.data.saveButtonState = '';\n\n    var SaveButtonStateService = this;\n\n    var setStateToSaving = function() {\n      SaveButtonStateService.data.saveButtonState = SAVE_BUTTON_STATES.SAVING;\n    };\n\n    var setStateToSaved = function() {\n      SaveButtonStateService.data.saveButtonState = SAVE_BUTTON_STATES.SAVED;\n    };\n\n    var clearState = function() {\n      SaveButtonStateService.data.saveButtonState = '';\n    };\n    this.displaySavingAnimation = function() {\n      var defer = $q.defer();\n      setStateToSaving();\n      $timeout(setStateToSaved, 2000)\n        .then(function() {\n          $timeout(clearState, 1000).then(function() {\n            defer.resolve();\n          });\n        });\n      return defer.promise;\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .directive('dropdownSelector', ['$injector', function($injector) {\n    return {\n      templateUrl: 'shared/dropdownselector/dropdownselector.html',\n      scope: {\n        'ngModel': '=',\n        'ngRequired': '@',\n        'service': '@',\n        'placeholderText': '@',\n      },\n      controller: function($scope) {\n        var service = $injector.get($scope.service);\n        $scope.populateCurrentItemsList = function() {\n          service.getList({\n            'page_size': 100\n          }).then(function(results) {\n            $scope.currentItems = results;\n          });\n        };\n\n        $scope.populateCurrentItemsList();\n      }\n    };\n  }]);\n","'use strict';\n\nangular.module('videoHub')\n  .directive('filterButtons', ['ListService', function (ListService) {\n    return {\n      controller: function ($scope) {\n\n        $scope.params = ListService.getParams();\n\n        /**\n         * Set a filter value on {@link ListService} then update its content.\n         *\n         * @param {String} newFilterValue - New filter to add to {@link ListService}.\n         * @returns {Promise} resolves based on {@link ListService.updateList} and the\n         *  update callback passed into this directive.\n         */\n        $scope.setFilterAndUpdateList = function (newFilterValue) {\n\n          ListService.setFilter(newFilterValue);\n          $scope.params = ListService.getParams();\n\n          return ListService.updateList().then(function () {\n            if ($scope.updateCallback) {\n              $scope.updateCallback();\n            }\n          });\n        };\n\n      },\n      restrict: 'E',\n      scope: {\n        updateCallback: '&'\n      },\n      templateUrl: 'shared/filter-buttons/filter-buttons.html'\n    };\n  }]);\n","'use strict';\nangular.module('videoHub')\n  .directive('listPageColumn', function(){\n    return {\n      templateUrl: 'shared/list-page-column/list-page-column.html',\n      replace: true,\n      restrict: 'A',\n      scope: {\n        'length': '@',\n        'text': '@',\n        'columnWidth': '@'\n      },\n      link: function(scope){\n        if (scope.text.length > scope.length) {\n          scope.truncatedText = _.trunc(scope.text, scope.length);\n          scope.tooltipText  = scope.text;\n          scope.displayText = scope.truncatedText;\n          scope.tooltipTrigger = null;\n        } else {\n          scope.tooltipTrigger = 'hover';\n          scope.displayText = scope.text;\n        }\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .directive('listNavBar', function() {\n    return {\n      'restrict': 'E',\n      'templateUrl': 'shared/listnavbar/listnavbar.html',\n      'scope': {\n        'activeNavbarTab': '@'\n      },\n      'controller': function($scope, $rootScope, $location, CurrentUser, LOGO_URL) {\n        $scope.LOGO_URL = LOGO_URL;\n        $scope.currentUserName = CurrentUser.getCurrentUser();\n        $scope.logout = function() {\n          CurrentUser.logout();\n        };\n      }\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .service('ListService', function($location, $injector, ValidQueryParamsForListPage) {\n\n    this.data = {};\n    var ListService = this;\n    this.service = null;\n    var currentService = null;\n\n    this.getParams = function() {\n      return this.data.params;\n    };\n\n    this.setService = function(serviceName) {\n      this.service = $injector.get(serviceName);\n      currentService = this.service;\n      this.data.params = $location.search();\n      this.data.list = [];\n      this.data.totalItems = 0;\n    };\n\n    this.clearSearch = function() {\n      this.data.params.q = '';\n    };\n\n    this.setFilter = function(newFilterValue) {\n      this.data.params.f = newFilterValue;\n    };\n\n    this.setList = function(list) {\n      ListService.data.list = list;\n      if (list.meta) {\n        ListService.data.totalItems = list.meta.count;\n      } else {\n        list.meta = {};\n        list.meta.count = 0;\n      }\n    };\n\n    this.setSearch = function(searchQuery) {\n      this.data.params.q = searchQuery;\n    };\n\n    this.setOrder = function(newOrderValue) {\n      var orderBy = this.data.params.order_by;\n      var orderByContainsNewOrderValue = _.endsWith(orderBy, newOrderValue);\n      var orderByIsAlreadyInverted = _.startsWith(orderBy, '-');\n      if (orderByContainsNewOrderValue && !orderByIsAlreadyInverted) {\n        orderBy = '-' + newOrderValue;\n      } else if (orderByContainsNewOrderValue && orderByIsAlreadyInverted) {\n        //If the existing orderBy value is already inverted, remove it.\n        orderBy = null;\n      } else {\n        orderBy = newOrderValue;\n      }\n\n      this.data.params.order_by = orderBy;\n    };\n\n    this.setPage = function(pageNumber) {\n      this.data.params.page = pageNumber;\n    };\n\n    this.updateList = function() {\n      this.data.params = _.pick(this.data.params, ValidQueryParamsForListPage);\n      this.data.params = _.omit(this.data.params, function(value) {\n        return _.isEmpty(value) && !_.isNumber(value);\n      });\n      $location.search(this.data.params);\n      return currentService.getList(this.data.params).then(ListService.setList);\n    };\n  });\n","'use strict';\n\nangular.module('videoHub').directive('navDropdown', [\n  function() {\n    return {\n      controller: function($scope) {\n        $scope.sections = [{\n          href: 'cms/',\n          title: 'Videos'\n        }, {\n          href: 'cms/series/',\n          title: 'Series'\n        }, {\n          href: 'cms/channels/',\n          title: 'Channels'\n        }, {\n          href: 'cms/sponsors/',\n          title: 'Sponsors'\n        }, {\n          href: 'cms/sliders/',\n          title: 'Sliders'\n        }];\n\n        $scope.sections = _.sortBy($scope.sections, function(element){\n          return element.title;\n        });\n      },\n      restrict: 'E',\n      scope: {\n        active: '@'\n      },\n      templateUrl: 'shared/nav-dropdown/nav-dropdown.html'\n    };\n  }\n]);\n","/**\n * dirPagination - AngularJS module for paginating (almost) anything.\n *\n *\n * Credits\n * =======\n *\n * Daniel Tabuenca: https://groups.google.com/d/msg/angular/an9QpzqIYiM/r8v-3W1X5vcJ\n * for the idea on how to dynamically invoke the ng-repeat directive.\n *\n * I borrowed a couple of lines and a few attribute names from the AngularUI Bootstrap project:\n * https://github.com/angular-ui/bootstrap/blob/master/src/pagination/pagination.js\n *\n * Copyright 2014 Michael Bromley <michael@michaelbromley.co.uk>\n */\n\n(function() {\n\n    /**\n     * Config\n     */\n    var moduleName = 'videoHub';\n    var DEFAULT_ID = '__default';\n\n    /**\n     * Module\n     */\n    var module;\n    try {\n        module = angular.module(moduleName);\n    } catch(err) {\n        // named module does not exist, so create one\n        module = angular.module(moduleName, []);\n    }\n\n    module.directive('dirPaginate', ['$compile', '$parse', '$timeout', 'paginationService', function($compile, $parse, $timeout, paginationService) {\n\n        return  {\n            terminal: true,\n            multiElement: true,\n            priority: 5000, // This setting is used in conjunction with the later call to $compile() to prevent infinite recursion of compilation\n            compile: function dirPaginationCompileFn(tElement, tAttrs){\n\n                var expression = tAttrs.dirPaginate;\n                // regex taken directly from https://github.com/angular/angular.js/blob/master/src/ng/directive/ngRepeat.js#L211\n                var match = expression.match(/^\\s*([\\s\\S]+?)\\s+in\\s+([\\s\\S]+?)(?:\\s+track\\s+by\\s+([\\s\\S]+?))?\\s*$/);\n\n                var filterPattern = /\\|\\s*itemsPerPage\\s*:[^|]*/;\n                if (match[2].match(filterPattern) === null) {\n                    throw 'pagination directive: the \\'itemsPerPage\\' filter must be set.';\n                }\n                var itemsPerPageFilterRemoved = match[2].replace(filterPattern, '');\n                var collectionGetter = $parse(itemsPerPageFilterRemoved);\n\n                // If any value is specified for paginationId, we register the un-evaluated expression at this stage for the benefit of any\n                // dir-pagination-controls directives that may be looking for this ID.\n                var rawId = tAttrs.paginationId || DEFAULT_ID;\n                paginationService.registerInstance(rawId);\n\n                return function dirPaginationLinkFn(scope, element, attrs){\n\n                    // Now that we have access to the `scope` we can interpolate any expression given in the paginationId attribute and\n                    // potentially register a new ID if it evaluates to a different value than the rawId.\n                    var paginationId = $parse(attrs.paginationId)(scope) || attrs.paginationId || DEFAULT_ID;\n                    paginationService.registerInstance(paginationId);\n\n                    var repeatExpression;\n                    var idDefinedInFilter = !!expression.match(/(\\|\\s*itemsPerPage\\s*:[^|]*:[^|]*)/);\n                    if (paginationId !== DEFAULT_ID && !idDefinedInFilter) {\n                        repeatExpression = expression.replace(/(\\|\\s*itemsPerPage\\s*:[^|]*)/, \"$1 : '\" + paginationId + \"'\");\n                    } else {\n                        repeatExpression = expression;\n                    }\n\n                    // Add ng-repeat to the dom element\n                    if (element[0].hasAttribute('dir-paginate-start') || element[0].hasAttribute('data-dir-paginate-start')) {\n                        // using multiElement mode (dir-paginate-start, dir-paginate-end)\n                        attrs.$set('ngRepeatStart', repeatExpression);\n                        element.eq(element.length - 1).attr('ng-repeat-end', true);\n                    } else {\n                        attrs.$set('ngRepeat', repeatExpression);\n                    }\n\n                    var compiled =  $compile(element, false, 5000); // we manually compile the element again, as we have now added ng-repeat. Priority less than 5000 prevents infinite recursion of compiling dirPaginate\n\n                    var currentPageGetter;\n                    if (attrs.currentPage) {\n                        currentPageGetter = $parse(attrs.currentPage);\n                    } else {\n                        // if the current-page attribute was not set, we'll make our own\n                        var defaultCurrentPage = paginationId + '__currentPage';\n                        scope[defaultCurrentPage] = 1;\n                        currentPageGetter = $parse(defaultCurrentPage);\n                    }\n                    paginationService.setCurrentPageParser(paginationId, currentPageGetter, scope);\n\n                    if (typeof attrs.totalItems !== 'undefined') {\n                        paginationService.setAsyncModeTrue(paginationId);\n                        scope.$watch(function() {\n                            return $parse(attrs.totalItems)(scope);\n                        }, function (result) {\n                            if (0 <= result) {\n                                paginationService.setCollectionLength(paginationId, result);\n                            }\n                        });\n                    } else {\n                        scope.$watchCollection(function() {\n                            return collectionGetter(scope);\n                        }, function(collection) {\n                            if (collection) {\n                                paginationService.setCollectionLength(paginationId, collection.length);\n                            }\n                        });\n                    }\n\n                    // Delegate to the link function returned by the new compilation of the ng-repeat\n                    compiled(scope);\n                };\n            }\n        };\n    }]);\n\n    module.directive('dirPaginationControls', ['paginationService', 'paginationTemplate', function(paginationService, paginationTemplate) {\n\n        var numberRegex = /^\\d+$/;\n\n        /**\n         * Generate an array of page numbers (or the '...' string) which is used in an ng-repeat to generate the\n         * links used in pagination\n         *\n         * @param currentPage\n         * @param rowsPerPage\n         * @param paginationRange\n         * @param collectionLength\n         * @returns {Array}\n         */\n        function generatePagesArray(currentPage, collectionLength, rowsPerPage, paginationRange) {\n            var pages = [];\n            var totalPages = Math.ceil(collectionLength / rowsPerPage);\n            var halfWay = Math.ceil(paginationRange / 2);\n            var position;\n\n            if (currentPage <= halfWay) {\n                position = 'start';\n            } else if (totalPages - halfWay < currentPage) {\n                position = 'end';\n            } else {\n                position = 'middle';\n            }\n\n            var ellipsesNeeded = paginationRange < totalPages;\n            var i = 1;\n            while (i <= totalPages && i <= paginationRange) {\n                var pageNumber = calculatePageNumber(i, currentPage, paginationRange, totalPages);\n\n                var openingEllipsesNeeded = (i === 2 && (position === 'middle' || position === 'end'));\n                var closingEllipsesNeeded = (i === paginationRange - 1 && (position === 'middle' || position === 'start'));\n                if (ellipsesNeeded && (openingEllipsesNeeded || closingEllipsesNeeded)) {\n                    pages.push('...');\n                } else {\n                    pages.push(pageNumber);\n                }\n                i ++;\n            }\n            return pages;\n        }\n\n        /**\n         * Given the position in the sequence of pagination links [i], figure out what page number corresponds to that position.\n         *\n         * @param i\n         * @param currentPage\n         * @param paginationRange\n         * @param totalPages\n         * @returns {*}\n         */\n        function calculatePageNumber(i, currentPage, paginationRange, totalPages) {\n            var halfWay = Math.ceil(paginationRange/2);\n            if (i === paginationRange) {\n                return totalPages;\n            } else if (i === 1) {\n                return i;\n            } else if (paginationRange < totalPages) {\n                if (totalPages - halfWay < currentPage) {\n                    return totalPages - paginationRange + i;\n                } else if (halfWay < currentPage) {\n                    return currentPage - halfWay + i;\n                } else {\n                    return i;\n                }\n            } else {\n                return i;\n            }\n        }\n\n        return {\n            restrict: 'AE',\n            templateUrl: function(elem, attrs) {\n                return attrs.templateUrl || paginationTemplate.getPath();\n            },\n            scope: {\n                maxSize: '=?',\n                onPageChange: '&?',\n                paginationId: '=?'\n            },\n            link: function dirPaginationControlsLinkFn(scope, element, attrs) {\n\n                // rawId is the un-interpolated value of the pagination-id attribute. This is only important when the corresponding dir-paginate directive has\n                // not yet been linked (e.g. if it is inside an ng-if block), and in that case it prevents this controls directive from assuming that there is\n                // no corresponding dir-paginate directive and wrongly throwing an exception.\n                var rawId = attrs.paginationId ||  DEFAULT_ID;\n                var paginationId = scope.paginationId || attrs.paginationId ||  DEFAULT_ID;\n\n                if (!paginationService.isRegistered(paginationId) && !paginationService.isRegistered(rawId)) {\n                    var idMessage = (paginationId !== DEFAULT_ID) ? ' (id: ' + paginationId + ') ' : ' ';\n                    throw 'pagination directive: the pagination controls' + idMessage + 'cannot be used without the corresponding pagination directive.';\n                }\n\n                if (!scope.maxSize) { scope.maxSize = 9; }\n                scope.directionLinks = angular.isDefined(attrs.directionLinks) ? scope.$parent.$eval(attrs.directionLinks) : true;\n                scope.boundaryLinks = angular.isDefined(attrs.boundaryLinks) ? scope.$parent.$eval(attrs.boundaryLinks) : false;\n\n                var paginationRange = Math.max(scope.maxSize, 5);\n                scope.pages = [];\n                scope.pagination = {\n                    last: 1,\n                    current: 1\n                };\n                scope.range = {\n                    lower: 1,\n                    upper: 1,\n                    total: 1\n                };\n\n                scope.$watch(function() {\n                    return (paginationService.getCollectionLength(paginationId) + 1) * paginationService.getItemsPerPage(paginationId);\n                }, function(length) {\n                    if (0 < length) {\n                        generatePagination();\n                    }\n                });\n\n                scope.$watch(function() {\n                    return (paginationService.getItemsPerPage(paginationId));\n                }, function(current, previous) {\n                    if (current != previous) {\n                        goToPage(scope.pagination.current);\n                    }\n                });\n\n                scope.$watch(function() {\n                    return paginationService.getCurrentPage(paginationId);\n                }, function(currentPage, previousPage) {\n                    if (currentPage != previousPage) {\n                        goToPage(currentPage);\n                    }\n                });\n\n                scope.setCurrent = function(num) {\n                    if (isValidPageNumber(num)) {\n                        paginationService.setCurrentPage(paginationId, num);\n                    }\n                };\n\n                function goToPage(num) {\n                    if (isValidPageNumber(num)) {\n                        scope.pages = generatePagesArray(num, paginationService.getCollectionLength(paginationId), paginationService.getItemsPerPage(paginationId), paginationRange);\n                        scope.pagination.current = num;\n                        updateRangeValues();\n\n                        // if a callback has been set, then call it with the page number as an argument\n                        if (scope.onPageChange) {\n                            scope.onPageChange({ newPageNumber : num });\n                        }\n                    }\n                }\n\n                function generatePagination() {\n                    var page = parseInt(paginationService.getCurrentPage(paginationId)) || 1;\n\n                    scope.pages = generatePagesArray(page, paginationService.getCollectionLength(paginationId), paginationService.getItemsPerPage(paginationId), paginationRange);\n                    scope.pagination.current = page;\n                    scope.pagination.last = scope.pages[scope.pages.length - 1];\n                    if (scope.pagination.last < scope.pagination.current) {\n                        scope.setCurrent(scope.pagination.last);\n                    } else {\n                        updateRangeValues();\n                    }\n                }\n\n                /**\n                 * This function updates the values (lower, upper, total) of the `scope.range` object, which can be used in the pagination\n                 * template to display the current page range, e.g. \"showing 21 - 40 of 144 results\";\n                 */\n                function updateRangeValues() {\n                    var currentPage = paginationService.getCurrentPage(paginationId),\n                        itemsPerPage = paginationService.getItemsPerPage(paginationId),\n                        totalItems = paginationService.getCollectionLength(paginationId);\n\n                    scope.range.lower = (currentPage - 1) * itemsPerPage + 1;\n                    scope.range.upper = Math.min(currentPage * itemsPerPage, totalItems);\n                    scope.range.total = totalItems;\n                }\n\n                function isValidPageNumber(num) {\n                    return (numberRegex.test(num) && (0 < num && num <= scope.pagination.last));\n                }\n            }\n        };\n    }]);\n\n    module.filter('itemsPerPage', ['paginationService', function(paginationService) {\n\n        return function(collection, itemsPerPage, paginationId) {\n            if (typeof (paginationId) === 'undefined') {\n                paginationId = DEFAULT_ID;\n            }\n            if (!paginationService.isRegistered(paginationId)) {\n                throw 'pagination directive: the itemsPerPage id argument (id: ' + paginationId + ') does not match a registered pagination-id.';\n            }\n            var end;\n            var start;\n            if (collection instanceof Array) {\n                itemsPerPage = parseInt(itemsPerPage) || 9999999999;\n                if (paginationService.isAsyncMode(paginationId)) {\n                    start = 0;\n                } else {\n                    start = (paginationService.getCurrentPage(paginationId) - 1) * itemsPerPage;\n                }\n                end = start + itemsPerPage;\n                paginationService.setItemsPerPage(paginationId, itemsPerPage);\n\n                return collection.slice(start, end);\n            } else {\n                return collection;\n            }\n        };\n    }]);\n\n    module.service('paginationService', function() {\n\n        var instances = {};\n        var lastRegisteredInstance;\n\n        this.registerInstance = function(instanceId) {\n            if (typeof instances[instanceId] === 'undefined') {\n                instances[instanceId] = {\n                    asyncMode: false\n                };\n                lastRegisteredInstance = instanceId;\n            }\n        };\n\n        this.isRegistered = function(instanceId) {\n            return (typeof instances[instanceId] !== 'undefined');\n        };\n\n        this.getLastInstanceId = function() {\n            return lastRegisteredInstance;\n        };\n\n        this.setCurrentPageParser = function(instanceId, val, scope) {\n            instances[instanceId].currentPageParser = val;\n            instances[instanceId].context = scope;\n        };\n        this.setCurrentPage = function(instanceId, val) {\n            instances[instanceId].currentPageParser.assign(instances[instanceId].context, val);\n        };\n        this.getCurrentPage = function(instanceId) {\n            var parser = instances[instanceId].currentPageParser;\n            return parser ? parser(instances[instanceId].context) : 1;\n        };\n\n        this.setItemsPerPage = function(instanceId, val) {\n            instances[instanceId].itemsPerPage = val;\n        };\n        this.getItemsPerPage = function(instanceId) {\n            return instances[instanceId].itemsPerPage;\n        };\n\n        this.setCollectionLength = function(instanceId, val) {\n            instances[instanceId].collectionLength = val;\n        };\n        this.getCollectionLength = function(instanceId) {\n            return instances[instanceId].collectionLength;\n        };\n\n        this.setAsyncModeTrue = function(instanceId) {\n            instances[instanceId].asyncMode = true;\n        };\n\n        this.isAsyncMode = function(instanceId) {\n            return instances[instanceId].asyncMode;\n        };\n    });\n\n    module.provider('paginationTemplate', function() {\n\n        var templatePath = 'shared/pagination/dirPagination.tpl.html';\n\n        this.setPath = function(path) {\n            templatePath = path;\n        };\n\n        this.$get = function() {\n            return {\n                getPath: function() {\n                    return templatePath;\n                }\n            };\n        };\n    });\n})();\n","'use strict';\nangular.module('videoHub')\n  .controller('SponsorSelectorModalController',\n    function($scope, SponsorService, $modalInstance) {\n      SponsorService.getList().then(function(data) {\n        $scope.sponsors = data;\n      });\n\n      $scope.selectSponsor = function(sponsor) {\n        $scope.sponsor = sponsor;\n      };\n\n      $scope.clearSponsor = function() {\n        $scope.sponsor = null;\n      };\n\n      $scope.close = function() {\n        $modalInstance.close($scope.sponsor);\n      };\n    });\n","'use strict';\n/**\n * Apply as an attribute to an element, when element is clicked it will open a\n *  a date time selection modal. All functionality is dependent on dates being\n *  moment objects.\n */\nangular.module('videoHub')\n  .directive('sponsorSelector', function($modal) {\n    return {\n      link: function(scope, element) {\n        var modalInstance = null;\n\n        element.addClass('sponsor-selection-modal-opener');\n\n        element.on('click', function() {\n          modalInstance = $modal\n            .open({\n              templateUrl: 'shared/sponsor-selection-modal/sponsor-selection-modal.html',\n              controller: 'SponsorSelectorModalController',\n              scope: scope\n            });\n          modalInstance.result\n            .then(function(newSponsor) {\n              scope.sponsor = newSponsor;\n              if (_.isFunction(scope.sponsorSelectionModalOnClose)) {\n                scope.sponsorSelectionModalOnClose({\n                  sponsor: newSponsor\n                });\n              }\n            });\n        });\n      },\n      restrict: 'A',\n      require: '^ngModel',\n      scope: {\n        sponsor: '=ngModel',\n        sponsorSelectonModalTitle: '@',\n        sponsorSelectionModalOnClose: '&'\n      }\n    };\n  });\n","'use strict';\nangular.module('videoHub')\n  .directive('tagsAutocomplete', function($injector) {\n    return {\n      templateUrl: 'shared/tags-autocomplete/tags-autocomplete.html',\n      scope: {\n        'items': '=',\n        'service': '@service',\n        'labelAttr': '@',\n        'placeholderText': '@'\n      },\n      controller: function($scope, AlertService) {\n        //Inject service based on provided value\n        var service = $injector.get($scope.service);\n\n        $scope.fetchItemsThatMatchSearch = function() {\n          if (_.isEmpty($scope.search) || $scope.search.length < 2) {\n            $scope.currentItems = [];\n          } else {\n            $scope.tagsAreBeingFetchedFromTheServer = true;\n            service.getList({\n              'q': $scope.search\n            }).then($scope.updateCurrentItemsAndDisplayDropdown,\n              function() {\n                AlertService.error('Somethign went wrong. Please contact your friendly sysadmin', true);\n              });\n          }\n        };\n\n        $scope.updateCurrentItemsAndDisplayDropdown = function(data) {\n          $scope.tagsAreBeingFetchedFromTheServer = false;\n          if (!_.isUndefined(data)) {\n            var currentItemsIds = _.pluck($scope.items, 'id');\n            data = _.reject(data, function(item) {\n              return _.contains(currentItemsIds, item.id);\n            });\n            $scope.currentItems = data;\n          } else {\n            $scope.currentItems = null;\n          }\n        };\n\n        $scope.clearSearch = function() {\n          $scope.search = '';\n          $scope.currentItems = [];\n          $scope.fetchItemsThatMatchSearch();\n          $scope.selectedElement = -1;\n        };\n\n        $scope.selectedElement = -1;\n        $scope.controlSelectedElementWithKeyboard = function(event) {\n          var keyCode = event.keyCode;\n          if (!_.isEmpty($scope.search)) {\n            var lastIndexOfCurrentItems = $scope.currentItems.length - 1;\n            switch (keyCode) {\n              case 27: // ESC\n                $scope.clearSearch();\n                break;\n              case 40: // DOWN\n                $scope.selectedElement = $scope.selectedElement >= lastIndexOfCurrentItems ?\n                  0 :\n                  $scope.selectedElement + 1;\n                break;\n              case 38: // UP\n                $scope.selectedElement = $scope.selectedElement <= 0 ?\n                  lastIndexOfCurrentItems :\n                  $scope.selectedElement - 1;\n                break;\n              case 13: // RETURN\n                if (!$scope.tagsAreBeingFetchedFromTheServer) {\n                  $scope.addItem($scope.currentItems[$scope.selectedElement]);\n                  $scope.selectedElement = -1;\n                }\n                break;\n              default:\n                return;\n            }\n          }\n\n        };\n\n        $scope.addItem = function(item) {\n          if (_.isUndefined(item)) {\n            item = {\n              'name': $scope.search\n            };\n            var isCurrentTagInCurrentItemsPredicate = _.matches(item);\n            var currentObjectFetchedFromCurrentItems = _.find($scope.currentItems, isCurrentTagInCurrentItemsPredicate);\n            if (currentObjectFetchedFromCurrentItems) {\n              $scope.items.push(currentObjectFetchedFromCurrentItems);\n            } else {\n              service.post(item).then(function(data) {\n                $scope.items.push(data);\n                $scope.clearSearch();\n              }, function() {\n                AlertService.error('Something went wrong. Plase contact your friendly sysadmin.', true);\n              });\n            }\n          } else {\n            $scope.items.push(item);\n          }\n          $scope.clearSearch();\n        };\n\n        $scope.removeItem = function(itemToBeRemovedFromArray) {\n          $scope.items = _.reject($scope.items, function(item) {\n            return item.id === itemToBeRemovedFromArray.id;\n          });\n        };\n      }\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .filter('tzDate', function (dateFilter, moment, TIMEZONE_NAME) {\n    return function (input, format) {\n      if (!input) {\n        return '';\n      }\n      var inDate = moment.tz(input, TIMEZONE_NAME);\n      var newdate = inDate.format('YYYY-MM-DDTHH:mm');\n      var formattedDate = dateFilter(newdate, format);\n      return formattedDate;\n    };\n  });\n","'use strict';\n\nangular.module('videoHub')\n  .directive('videoPlayer', [ function() {\n    return {\n      replace: false,\n      restrict: 'E',\n      transclude: true,\n      templateUrl: 'shared/videoplayer/videoplayer.html',\n      link: function(scope, element) {\n        var currentVideo = element.find('video')[0];\n        scope.player = videojs(currentVideo, {\n          'controls': true,\n          'autoplay': false,\n          'width': 'auto',\n          'height': 'auto'\n        });\n\n        element.find('.modal').on('hidden.bs.modal', function(){\n          scope.player.pause();\n        });\n\n        scope.$on('$destroy', function(){\n          scope.player.dispose();\n        });\n      }\n    };\n  }]);\n"]}